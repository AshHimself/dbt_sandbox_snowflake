2021-06-06 03:19:37.947834 (MainThread): Running with dbt=0.19.1
2021-06-06 03:19:39.163877 (MainThread): Loading KWallet
2021-06-06 03:19:39.164408 (MainThread): Loading SecretService
2021-06-06 03:19:39.164834 (MainThread): Loading Windows
2021-06-06 03:19:39.165191 (MainThread): Loading chainer
2021-06-06 03:19:39.165380 (MainThread): Loading macOS
2021-06-06 03:19:39.789809 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 03:19:39.791020 (MainThread): Tracking: tracking
2021-06-06 03:19:39.791275 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65350de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6541eaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6541eaf70>]}
2021-06-06 03:19:39.798342 (MainThread): Partial parsing not enabled
2021-06-06 03:19:39.799380 (MainThread): Parsing macros/catalog.sql
2021-06-06 03:19:39.801316 (MainThread): Parsing macros/adapters.sql
2021-06-06 03:19:39.825262 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 03:19:39.826808 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 03:19:39.827855 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 03:19:39.830753 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 03:19:39.838066 (MainThread): Parsing macros/core.sql
2021-06-06 03:19:39.840836 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 03:19:39.847064 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 03:19:39.848274 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 03:19:39.860609 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 03:19:39.887851 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 03:19:39.903218 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 03:19:39.904483 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 03:19:39.908711 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 03:19:39.919224 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 03:19:39.924308 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 03:19:39.928920 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 03:19:39.932418 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 03:19:39.933051 (MainThread): Parsing macros/etc/query.sql
2021-06-06 03:19:39.933851 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 03:19:39.934953 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 03:19:39.941234 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 03:19:39.942565 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 03:19:39.943684 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 03:19:39.975449 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 03:19:39.976715 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 03:19:39.977697 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 03:19:39.978812 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 03:19:39.983951 (MainThread): Partial parsing not enabled
2021-06-06 03:19:39.998847 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:19:40.005248 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:19:40.087727 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dc0abf8-7ab2-4b65-803f-e2682d2543d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe654dea910>]}
2021-06-06 03:19:40.092437 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dc0abf8-7ab2-4b65-803f-e2682d2543d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe654d947c0>]}
2021-06-06 03:19:40.092562 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-06 03:19:40.093111 (MainThread): 
2021-06-06 03:19:40.093372 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:19:40.094006 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_analytics".
2021-06-06 03:19:40.102343 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_analytics".
2021-06-06 03:19:40.102459 (ThreadPoolExecutor-0_0): On list_dbt_analytics: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_dbt_analytics"} */

    show terse schemas in database dbt_analytics
    limit 10000
2021-06-06 03:19:40.102507 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 03:19:42.431975 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.33 seconds
2021-06-06 03:19:42.440403 (ThreadPoolExecutor-0_0): On list_dbt_analytics: Close
2021-06-06 03:19:43.088002 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_dbt_analytics_public".
2021-06-06 03:19:43.099615 (ThreadPoolExecutor-1_0): Using snowflake connection "list_dbt_analytics_public".
2021-06-06 03:19:43.099766 (ThreadPoolExecutor-1_0): On list_dbt_analytics_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_dbt_analytics_public"} */

    show terse objects in dbt_analytics.public
2021-06-06 03:19:43.099875 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 03:19:45.111657 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 2.01 seconds
2021-06-06 03:19:45.114625 (ThreadPoolExecutor-1_0): On list_dbt_analytics_public: Close
2021-06-06 03:19:45.726335 (MainThread): Using snowflake connection "master".
2021-06-06 03:19:45.726575 (MainThread): On master: BEGIN
2021-06-06 03:19:45.726714 (MainThread): Opening a new connection, currently in state init
2021-06-06 03:19:47.908638 (MainThread): SQL status: SUCCESS 1 in 2.18 seconds
2021-06-06 03:19:47.909441 (MainThread): On master: COMMIT
2021-06-06 03:19:47.909923 (MainThread): Using snowflake connection "master".
2021-06-06 03:19:47.910105 (MainThread): On master: COMMIT
2021-06-06 03:19:48.365259 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-06-06 03:19:48.366251 (MainThread): On master: Close
2021-06-06 03:19:48.969160 (MainThread): 11:19:48 | Concurrency: 1 threads (target='dev')
2021-06-06 03:19:48.969567 (MainThread): 11:19:48 | 
2021-06-06 03:19:48.971409 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-06 03:19:48.971880 (Thread-1): 11:19:48 | 1 of 2 START table model public.my_first_dbt_model................... [RUN]
2021-06-06 03:19:48.972354 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:19:48.972526 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-06 03:19:48.978303 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-06 03:19:48.979368 (Thread-1): finished collecting timing info
2021-06-06 03:19:49.014521 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-06 03:19:49.015735 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:19:49.015817 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-06 03:19:49.015903 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 03:19:50.718040 (Thread-1): SQL status: SUCCESS 1 in 1.70 seconds
2021-06-06 03:19:50.719707 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:19:50.720009 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


      create or replace transient table dbt_analytics.public.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-06-06 03:19:53.222128 (Thread-1): SQL status: SUCCESS 1 in 2.50 seconds
2021-06-06 03:19:53.225826 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-06 03:19:53.226338 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:19:53.226503 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-06 03:19:53.549926 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-06-06 03:19:53.569089 (Thread-1): finished collecting timing info
2021-06-06 03:19:53.569379 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-06 03:19:54.202666 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dc0abf8-7ab2-4b65-803f-e2682d2543d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe654bc5640>]}
2021-06-06 03:19:54.203376 (Thread-1): 11:19:54 | 1 of 2 OK created table model public.my_first_dbt_model.............. [SUCCESS 1 in 5.23s]
2021-06-06 03:19:54.203654 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-06 03:19:54.205762 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-06 03:19:54.206217 (Thread-1): 11:19:54 | 2 of 2 START view model public.my_second_dbt_model................... [RUN]
2021-06-06 03:19:54.206637 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:19:54.206787 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-06 03:19:54.211213 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-06 03:19:54.211967 (Thread-1): finished collecting timing info
2021-06-06 03:19:54.236205 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-06 03:19:54.239461 (Thread-1): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:19:54.239575 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-06 03:19:54.239657 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 03:19:56.204678 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2021-06-06 03:19:56.205485 (Thread-1): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:19:56.205672 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view dbt_analytics.public.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from dbt_analytics.public.my_first_dbt_model
where id = 1
  );
2021-06-06 03:19:56.828564 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-06-06 03:19:56.831331 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-06 03:19:56.831779 (Thread-1): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:19:56.831949 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-06 03:19:57.164380 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-06-06 03:19:57.167273 (Thread-1): finished collecting timing info
2021-06-06 03:19:57.167989 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-06 03:19:57.816157 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dc0abf8-7ab2-4b65-803f-e2682d2543d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6401194c0>]}
2021-06-06 03:19:57.817633 (Thread-1): 11:19:57 | 2 of 2 OK created view model public.my_second_dbt_model.............. [SUCCESS 1 in 3.61s]
2021-06-06 03:19:57.817959 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-06 03:19:57.820189 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:19:57.823117 (MainThread): Using snowflake connection "master".
2021-06-06 03:19:57.823433 (MainThread): On master: BEGIN
2021-06-06 03:19:57.823668 (MainThread): Opening a new connection, currently in state closed
2021-06-06 03:19:59.777953 (MainThread): SQL status: SUCCESS 1 in 1.95 seconds
2021-06-06 03:19:59.778829 (MainThread): On master: COMMIT
2021-06-06 03:19:59.779330 (MainThread): Using snowflake connection "master".
2021-06-06 03:19:59.779570 (MainThread): On master: COMMIT
2021-06-06 03:20:00.206858 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-06-06 03:20:00.207456 (MainThread): On master: Close
2021-06-06 03:20:00.887659 (MainThread): 11:20:00 | 
2021-06-06 03:20:00.888139 (MainThread): 11:20:00 | Finished running 1 table model, 1 view model in 20.79s.
2021-06-06 03:20:00.888362 (MainThread): Connection 'master' was properly closed.
2021-06-06 03:20:00.888505 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-06 03:20:00.898779 (MainThread): 
2021-06-06 03:20:00.899140 (MainThread): Completed successfully
2021-06-06 03:20:00.899366 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-06 03:20:00.899681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe654d75880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64012df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64012d670>]}
2021-06-06 03:20:00.900035 (MainThread): Flushing usage events
2021-06-06 03:32:13.968026 (MainThread): Running with dbt=0.19.1
2021-06-06 03:32:14.563153 (MainThread): Loading KWallet
2021-06-06 03:32:14.563555 (MainThread): Loading SecretService
2021-06-06 03:32:14.563829 (MainThread): Loading Windows
2021-06-06 03:32:14.564175 (MainThread): Loading chainer
2021-06-06 03:32:14.564351 (MainThread): Loading macOS
2021-06-06 03:32:14.829709 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 03:32:14.831253 (MainThread): Tracking: tracking
2021-06-06 03:32:14.831502 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993b526f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c175b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c175e20>]}
2021-06-06 03:32:14.838742 (MainThread): Partial parsing not enabled
2021-06-06 03:32:14.839690 (MainThread): Parsing macros/catalog.sql
2021-06-06 03:32:14.841655 (MainThread): Parsing macros/adapters.sql
2021-06-06 03:32:14.864774 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 03:32:14.866300 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 03:32:14.867401 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 03:32:14.870234 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 03:32:14.877460 (MainThread): Parsing macros/core.sql
2021-06-06 03:32:14.880238 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 03:32:14.886516 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 03:32:14.887740 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 03:32:14.900067 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 03:32:14.926804 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 03:32:14.942238 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 03:32:14.943498 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 03:32:14.947712 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 03:32:14.958202 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 03:32:14.963214 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 03:32:14.967798 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 03:32:14.971302 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 03:32:14.971928 (MainThread): Parsing macros/etc/query.sql
2021-06-06 03:32:14.972714 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 03:32:14.973813 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 03:32:14.980094 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 03:32:14.981427 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 03:32:14.982537 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 03:32:15.014536 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 03:32:15.015796 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 03:32:15.016772 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 03:32:15.017896 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 03:32:15.023022 (MainThread): Partial parsing not enabled
2021-06-06 03:32:15.038710 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:32:15.045059 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:32:15.047261 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:32:15.128488 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1427e2ba-de7b-4d29-97b4-c39d4d06c3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ccbba60>]}
2021-06-06 03:32:15.130839 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1427e2ba-de7b-4d29-97b4-c39d4d06c3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993cbc2ca0>]}
2021-06-06 03:32:15.130959 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-06 03:32:15.131507 (MainThread): 
2021-06-06 03:32:15.131713 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:32:15.132414 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-06 03:32:15.141177 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-06 03:32:15.141288 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-06 03:32:15.141344 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 03:32:16.425103 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.28 seconds
2021-06-06 03:32:16.433473 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-06 03:32:16.709637 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 03:32:16.721192 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 03:32:16.721352 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 03:32:16.721475 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 03:32:17.557878 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.84 seconds
2021-06-06 03:32:17.559613 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-06 03:32:17.847164 (MainThread): Using snowflake connection "master".
2021-06-06 03:32:17.847434 (MainThread): On master: BEGIN
2021-06-06 03:32:17.847575 (MainThread): Opening a new connection, currently in state init
2021-06-06 03:32:18.923676 (MainThread): SQL status: SUCCESS 1 in 1.08 seconds
2021-06-06 03:32:18.924426 (MainThread): On master: COMMIT
2021-06-06 03:32:18.924867 (MainThread): Using snowflake connection "master".
2021-06-06 03:32:18.925043 (MainThread): On master: COMMIT
2021-06-06 03:32:19.181224 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-06-06 03:32:19.182052 (MainThread): On master: Close
2021-06-06 03:32:19.464988 (MainThread): 11:32:19 | Concurrency: 1 threads (target='dev')
2021-06-06 03:32:19.465363 (MainThread): 11:32:19 | 
2021-06-06 03:32:19.466890 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-06 03:32:19.467178 (Thread-1): 11:32:19 | 1 of 3 START table model public.my_first_dbt_model................... [RUN]
2021-06-06 03:32:19.467410 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:32:19.467483 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-06 03:32:19.469451 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-06 03:32:19.470000 (Thread-1): finished collecting timing info
2021-06-06 03:32:19.488193 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-06 03:32:19.488957 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:32:19.489015 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-06 03:32:19.489068 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 03:32:20.322906 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-06-06 03:32:20.323693 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:32:20.323878 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


      create or replace transient table test_dbt.public.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-06-06 03:32:23.478355 (Thread-1): SQL status: SUCCESS 1 in 3.15 seconds
2021-06-06 03:32:23.482524 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-06 03:32:23.482889 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2021-06-06 03:32:23.483020 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-06 03:32:23.653432 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-06 03:32:23.673388 (Thread-1): finished collecting timing info
2021-06-06 03:32:23.673659 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-06 03:32:23.932956 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1427e2ba-de7b-4d29-97b4-c39d4d06c3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993cef4e50>]}
2021-06-06 03:32:23.933593 (Thread-1): 11:32:23 | 1 of 3 OK created table model public.my_first_dbt_model.............. [SUCCESS 1 in 4.47s]
2021-06-06 03:32:23.933838 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-06 03:32:23.934034 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 03:32:23.935190 (Thread-1): 11:32:23 | 2 of 3 START view model public.customer_orders....................... [RUN]
2021-06-06 03:32:23.935922 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:32:23.936112 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 03:32:23.938731 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:32:23.939482 (Thread-1): finished collecting timing info
2021-06-06 03:32:23.960137 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:32:23.962500 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:32:23.962623 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-06 03:32:23.962717 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 03:32:24.862769 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-06-06 03:32:24.863493 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:32:24.863638 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with cte_customer as (
  
  select 
    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
  FROM customers
  ), 
  
  cte_orders as (
  select 
    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
    from orders
  ),
  cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from cte_orders
    group by 1
  ),
  
  final as (
    
    select * from cte_orders
    inner join cte_customer_orders on cte_orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-06 03:32:25.055439 (Thread-1): Snowflake query id: 019cbcd4-3200-4d88-0000-000065a95071
2021-06-06 03:32:25.056070 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TEST_DBT.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-06-06 03:32:25.056849 (Thread-1): finished collecting timing info
2021-06-06 03:32:25.057264 (Thread-1): On model.my_new_project.customer_orders: ROLLBACK
2021-06-06 03:32:25.286701 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-06 03:32:25.583156 (Thread-1): Database Error in model customer_orders (models/orders/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'TEST_DBT.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/my_new_project/models/orders/customer_orders.sql
Traceback (most recent call last):
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'TEST_DBT.PUBLIC.CUSTOMERS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/orders/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'TEST_DBT.PUBLIC.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target/run/my_new_project/models/orders/customer_orders.sql
2021-06-06 03:32:25.592919 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1427e2ba-de7b-4d29-97b4-c39d4d06c3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993cf0ab80>]}
2021-06-06 03:32:25.593462 (Thread-1): 11:32:25 | 2 of 3 ERROR creating view model public.customer_orders.............. [ERROR in 1.66s]
2021-06-06 03:32:25.593631 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 03:32:25.593805 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-06 03:32:25.594267 (Thread-1): 11:32:25 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2021-06-06 03:32:25.594727 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:32:25.594876 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-06 03:32:25.597948 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-06 03:32:25.598455 (Thread-1): finished collecting timing info
2021-06-06 03:32:25.601413 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-06 03:32:25.602462 (Thread-1): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:32:25.602576 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-06 03:32:25.602673 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 03:32:26.708299 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-06-06 03:32:26.709062 (Thread-1): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:32:26.709207 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view test_dbt.public.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from test_dbt.public.my_first_dbt_model
where id = 1
  );
2021-06-06 03:32:27.060406 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-06-06 03:32:27.063536 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-06 03:32:27.063939 (Thread-1): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2021-06-06 03:32:27.064097 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-06 03:32:27.222202 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-06-06 03:32:27.224681 (Thread-1): finished collecting timing info
2021-06-06 03:32:27.225012 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-06 03:32:27.522603 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1427e2ba-de7b-4d29-97b4-c39d4d06c3ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993cea3a90>]}
2021-06-06 03:32:27.523119 (Thread-1): 11:32:27 | 3 of 3 OK created view model public.my_second_dbt_model.............. [SUCCESS 1 in 1.93s]
2021-06-06 03:32:27.523274 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-06 03:32:27.524895 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:32:27.525137 (MainThread): Using snowflake connection "master".
2021-06-06 03:32:27.525223 (MainThread): On master: BEGIN
2021-06-06 03:32:27.525308 (MainThread): Opening a new connection, currently in state closed
2021-06-06 03:32:28.391257 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-06-06 03:32:28.392008 (MainThread): On master: COMMIT
2021-06-06 03:32:28.392413 (MainThread): Using snowflake connection "master".
2021-06-06 03:32:28.392591 (MainThread): On master: COMMIT
2021-06-06 03:32:28.657670 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-06-06 03:32:28.658463 (MainThread): On master: Close
2021-06-06 03:32:28.930503 (MainThread): 11:32:28 | 
2021-06-06 03:32:28.930916 (MainThread): 11:32:28 | Finished running 1 table model, 2 view models in 13.80s.
2021-06-06 03:32:28.931122 (MainThread): Connection 'master' was properly closed.
2021-06-06 03:32:28.931255 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-06 03:32:28.931374 (MainThread): Connection 'list_test_dbt_public' was properly closed.
2021-06-06 03:32:28.940964 (MainThread): 
2021-06-06 03:32:28.941280 (MainThread): Completed with 1 error and 0 warnings:
2021-06-06 03:32:28.941439 (MainThread): 
2021-06-06 03:32:28.941579 (MainThread): Database Error in model customer_orders (models/orders/customer_orders.sql)
2021-06-06 03:32:28.941701 (MainThread):   002003 (42S02): SQL compilation error:
2021-06-06 03:32:28.941810 (MainThread):   Object 'TEST_DBT.PUBLIC.CUSTOMERS' does not exist or not authorized.
2021-06-06 03:32:28.941919 (MainThread):   compiled SQL at target/run/my_new_project/models/orders/customer_orders.sql
2021-06-06 03:32:28.942048 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-06-06 03:32:28.942277 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993cd2a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993cae61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9908042b20>]}
2021-06-06 03:32:28.942562 (MainThread): Flushing usage events
2021-06-06 03:41:42.412098 (MainThread): Running with dbt=0.19.1
2021-06-06 03:41:42.978897 (MainThread): Loading KWallet
2021-06-06 03:41:42.979259 (MainThread): Loading SecretService
2021-06-06 03:41:42.979529 (MainThread): Loading Windows
2021-06-06 03:41:42.979872 (MainThread): Loading chainer
2021-06-06 03:41:42.980046 (MainThread): Loading macOS
2021-06-06 03:41:43.255477 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 03:41:43.256473 (MainThread): Tracking: tracking
2021-06-06 03:41:43.256734 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc153445dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc15417db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc15417de20>]}
2021-06-06 03:41:43.264109 (MainThread): Partial parsing not enabled
2021-06-06 03:41:43.265147 (MainThread): Parsing macros/catalog.sql
2021-06-06 03:41:43.267053 (MainThread): Parsing macros/adapters.sql
2021-06-06 03:41:43.290087 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 03:41:43.291554 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 03:41:43.292601 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 03:41:43.295584 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 03:41:43.302842 (MainThread): Parsing macros/core.sql
2021-06-06 03:41:43.305643 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 03:41:43.311929 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 03:41:43.313149 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 03:41:43.325553 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 03:41:43.352946 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 03:41:43.368395 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 03:41:43.369651 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 03:41:43.373887 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 03:41:43.384428 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 03:41:43.389489 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 03:41:43.394086 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 03:41:43.397589 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 03:41:43.398213 (MainThread): Parsing macros/etc/query.sql
2021-06-06 03:41:43.399032 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 03:41:43.400129 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 03:41:43.406423 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 03:41:43.407743 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 03:41:43.408855 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 03:41:43.440993 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 03:41:43.442236 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 03:41:43.443220 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 03:41:43.444328 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 03:41:43.449518 (MainThread): Partial parsing not enabled
2021-06-06 03:41:43.464703 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:41:43.537625 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 03:41:43.537775 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c3371f2-fd5d-4468-9e1c-f96767a4d32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc154cc5e50>]}
2021-06-06 03:41:43.540719 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c3371f2-fd5d-4468-9e1c-f96767a4d32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc154dd06d0>]}
2021-06-06 03:41:43.540899 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-06 03:41:43.541266 (MainThread): 
2021-06-06 03:41:43.541448 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:41:43.541960 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-06 03:41:43.550413 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-06 03:41:43.550484 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-06 03:41:43.550539 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 03:41:44.873990 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.32 seconds
2021-06-06 03:41:44.882994 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-06 03:41:45.174704 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 03:41:45.186203 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 03:41:45.186357 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 03:41:45.186463 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 03:41:46.304528 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.12 seconds
2021-06-06 03:41:46.307954 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-06 03:41:46.622749 (MainThread): Using snowflake connection "master".
2021-06-06 03:41:46.622993 (MainThread): On master: BEGIN
2021-06-06 03:41:46.623121 (MainThread): Opening a new connection, currently in state init
2021-06-06 03:41:47.515845 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-06-06 03:41:47.516544 (MainThread): On master: COMMIT
2021-06-06 03:41:47.516883 (MainThread): Using snowflake connection "master".
2021-06-06 03:41:47.517026 (MainThread): On master: COMMIT
2021-06-06 03:41:47.761941 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-06-06 03:41:47.762841 (MainThread): On master: Close
2021-06-06 03:41:48.036398 (MainThread): 11:41:48 | Concurrency: 1 threads (target='dev')
2021-06-06 03:41:48.036981 (MainThread): 11:41:48 | 
2021-06-06 03:41:48.039045 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 03:41:48.039726 (Thread-1): 11:41:48 | 1 of 1 START view model public.customer_orders....................... [RUN]
2021-06-06 03:41:48.040374 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:41:48.040576 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 03:41:48.043288 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:41:48.044285 (Thread-1): finished collecting timing info
2021-06-06 03:41:48.077573 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:41:48.079631 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:41:48.079726 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-06 03:41:48.079803 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 03:41:48.918187 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-06-06 03:41:48.919046 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:41:48.919297 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with cte_customer as (
  
  select 
    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
  FROM test_raw.public.customers
  ), 
  
  cte_orders as (
  select 
    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
    from test_raw.public.orders
  ),
  cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from cte_orders
    group by 1
  ),
  
  final as (
    
    select * from cte_orders
    inner join cte_customer_orders on cte_orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-06 03:41:49.133396 (Thread-1): Snowflake query id: 019cbcdd-3200-4d89-0000-000065a960dd
2021-06-06 03:41:49.134147 (Thread-1): Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_ID'
2021-06-06 03:41:49.135047 (Thread-1): finished collecting timing info
2021-06-06 03:41:49.135569 (Thread-1): On model.my_new_project.customer_orders: ROLLBACK
2021-06-06 03:41:49.361662 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-06 03:41:49.646511 (Thread-1): Database Error in model customer_orders (models/orders/customer_orders.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled SQL at target/run/my_new_project/models/orders/customer_orders.sql
Traceback (most recent call last):
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/orders/customer_orders.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled SQL at target/run/my_new_project/models/orders/customer_orders.sql
2021-06-06 03:41:49.655021 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3371f2-fd5d-4468-9e1c-f96767a4d32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc154f214c0>]}
2021-06-06 03:41:49.655510 (Thread-1): 11:41:49 | 1 of 1 ERROR creating view model public.customer_orders.............. [ERROR in 1.61s]
2021-06-06 03:41:49.655689 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 03:41:49.658097 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:41:49.658400 (MainThread): Using snowflake connection "master".
2021-06-06 03:41:49.658501 (MainThread): On master: BEGIN
2021-06-06 03:41:49.658593 (MainThread): Opening a new connection, currently in state closed
2021-06-06 03:41:50.617779 (MainThread): SQL status: SUCCESS 1 in 0.96 seconds
2021-06-06 03:41:50.618433 (MainThread): On master: COMMIT
2021-06-06 03:41:50.618846 (MainThread): Using snowflake connection "master".
2021-06-06 03:41:50.619024 (MainThread): On master: COMMIT
2021-06-06 03:41:50.871237 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-06-06 03:41:50.872094 (MainThread): On master: Close
2021-06-06 03:41:51.147735 (MainThread): 11:41:51 | 
2021-06-06 03:41:51.148006 (MainThread): 11:41:51 | Finished running 1 view model in 7.61s.
2021-06-06 03:41:51.148165 (MainThread): Connection 'master' was properly closed.
2021-06-06 03:41:51.148267 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 03:41:51.154939 (MainThread): 
2021-06-06 03:41:51.155213 (MainThread): Completed with 1 error and 0 warnings:
2021-06-06 03:41:51.155373 (MainThread): 
2021-06-06 03:41:51.155517 (MainThread): Database Error in model customer_orders (models/orders/customer_orders.sql)
2021-06-06 03:41:51.155657 (MainThread):   002025 (42S21): SQL compilation error:
2021-06-06 03:41:51.155770 (MainThread):   duplicate column name 'CUSTOMER_ID'
2021-06-06 03:41:51.155881 (MainThread):   compiled SQL at target/run/my_new_project/models/orders/customer_orders.sql
2021-06-06 03:41:51.156002 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-06 03:41:51.156229 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc154cc5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc154cc5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc154f04ca0>]}
2021-06-06 03:41:51.156517 (MainThread): Flushing usage events
2021-06-06 03:46:57.199522 (MainThread): Running with dbt=0.19.1
2021-06-06 03:46:57.754590 (MainThread): Loading KWallet
2021-06-06 03:46:57.754962 (MainThread): Loading SecretService
2021-06-06 03:46:57.755233 (MainThread): Loading Windows
2021-06-06 03:46:57.755576 (MainThread): Loading chainer
2021-06-06 03:46:57.755753 (MainThread): Loading macOS
2021-06-06 03:46:58.025688 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 03:46:58.026916 (MainThread): Tracking: tracking
2021-06-06 03:46:58.027157 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9aefefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9bc4de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9bc4dfd0>]}
2021-06-06 03:46:58.034596 (MainThread): Partial parsing not enabled
2021-06-06 03:46:58.035377 (MainThread): Parsing macros/catalog.sql
2021-06-06 03:46:58.037320 (MainThread): Parsing macros/adapters.sql
2021-06-06 03:46:58.060850 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 03:46:58.062329 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 03:46:58.063341 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 03:46:58.066090 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 03:46:58.073262 (MainThread): Parsing macros/core.sql
2021-06-06 03:46:58.076067 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 03:46:58.082316 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 03:46:58.083690 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 03:46:58.096208 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 03:46:58.123860 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 03:46:58.139342 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 03:46:58.140592 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 03:46:58.144825 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 03:46:58.155471 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 03:46:58.160546 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 03:46:58.165154 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 03:46:58.168716 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 03:46:58.169353 (MainThread): Parsing macros/etc/query.sql
2021-06-06 03:46:58.170154 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 03:46:58.171262 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 03:46:58.177590 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 03:46:58.178916 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 03:46:58.180026 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 03:46:58.212542 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 03:46:58.213786 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 03:46:58.214762 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 03:46:58.215877 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 03:46:58.221046 (MainThread): Partial parsing not enabled
2021-06-06 03:46:58.235605 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:46:58.307634 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 03:46:58.307785 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88264dcd-e0f3-4835-b491-0c1599a30c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c794e80>]}
2021-06-06 03:46:58.310123 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88264dcd-e0f3-4835-b491-0c1599a30c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c5d1760>]}
2021-06-06 03:46:58.310312 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-06 03:46:58.310718 (MainThread): 
2021-06-06 03:46:58.310950 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:46:58.311549 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-06 03:46:58.319504 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-06 03:46:58.319557 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-06 03:46:58.319599 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 03:46:59.965188 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.65 seconds
2021-06-06 03:46:59.974254 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-06 03:47:00.267118 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 03:47:00.277978 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 03:47:00.278123 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 03:47:00.278235 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 03:47:02.003003 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.72 seconds
2021-06-06 03:47:02.005501 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-06 03:47:02.522629 (MainThread): Using snowflake connection "master".
2021-06-06 03:47:02.522894 (MainThread): On master: BEGIN
2021-06-06 03:47:02.523024 (MainThread): Opening a new connection, currently in state init
2021-06-06 03:47:03.420209 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-06-06 03:47:03.421114 (MainThread): On master: COMMIT
2021-06-06 03:47:03.421667 (MainThread): Using snowflake connection "master".
2021-06-06 03:47:03.421958 (MainThread): On master: COMMIT
2021-06-06 03:47:03.698454 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-06-06 03:47:03.699308 (MainThread): On master: Close
2021-06-06 03:47:03.980331 (MainThread): 11:47:03 | Concurrency: 1 threads (target='dev')
2021-06-06 03:47:03.980729 (MainThread): 11:47:03 | 
2021-06-06 03:47:03.982802 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 03:47:03.983265 (Thread-1): 11:47:03 | 1 of 1 START view model public.customer_orders....................... [RUN]
2021-06-06 03:47:03.983747 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:47:03.983916 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 03:47:03.986469 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:47:03.989109 (Thread-1): finished collecting timing info
2021-06-06 03:47:04.021369 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:47:04.023474 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:47:04.023554 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-06 03:47:04.023620 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 03:47:04.865136 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-06-06 03:47:04.865925 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:47:04.866140 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with cte_customer as (
  
  select 
    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
  FROM test_raw.public.customers
  ), 
  
  cte_orders as (
  select 
    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
    from test_raw.public.orders
  ),
  cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from cte_orders
    group by 1
  ),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from cte_orders
    inner join cte_customer_orders on cte_orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-06 03:47:05.307740 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-06-06 03:47:05.311341 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 03:47:05.311651 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:47:05.311766 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 03:47:05.468116 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-06-06 03:47:05.482767 (Thread-1): finished collecting timing info
2021-06-06 03:47:05.483034 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-06 03:47:05.770465 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88264dcd-e0f3-4835-b491-0c1599a30c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c9f20a0>]}
2021-06-06 03:47:05.771114 (Thread-1): 11:47:05 | 1 of 1 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.79s]
2021-06-06 03:47:05.771322 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 03:47:05.774136 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:47:05.774482 (MainThread): Using snowflake connection "master".
2021-06-06 03:47:05.774613 (MainThread): On master: BEGIN
2021-06-06 03:47:05.774731 (MainThread): Opening a new connection, currently in state closed
2021-06-06 03:47:06.622300 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-06-06 03:47:06.623206 (MainThread): On master: COMMIT
2021-06-06 03:47:06.623577 (MainThread): Using snowflake connection "master".
2021-06-06 03:47:06.623729 (MainThread): On master: COMMIT
2021-06-06 03:47:06.877113 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-06-06 03:47:06.877978 (MainThread): On master: Close
2021-06-06 03:47:07.150828 (MainThread): 11:47:07 | 
2021-06-06 03:47:07.151247 (MainThread): 11:47:07 | Finished running 1 view model in 8.84s.
2021-06-06 03:47:07.151460 (MainThread): Connection 'master' was properly closed.
2021-06-06 03:47:07.151594 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 03:47:07.159130 (MainThread): 
2021-06-06 03:47:07.159422 (MainThread): Completed successfully
2021-06-06 03:47:07.159591 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-06 03:47:07.159838 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c9e2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c9e2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c9e2250>]}
2021-06-06 03:47:07.160166 (MainThread): Flushing usage events
2021-06-06 03:49:01.139603 (MainThread): Running with dbt=0.19.1
2021-06-06 03:49:01.649572 (MainThread): Loading KWallet
2021-06-06 03:49:01.649924 (MainThread): Loading SecretService
2021-06-06 03:49:01.650190 (MainThread): Loading Windows
2021-06-06 03:49:01.650532 (MainThread): Loading chainer
2021-06-06 03:49:01.650703 (MainThread): Loading macOS
2021-06-06 03:49:01.911339 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-06-06 03:49:01.912679 (MainThread): Tracking: tracking
2021-06-06 03:49:01.912940 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59316eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff593e89940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff593e899a0>]}
2021-06-06 03:49:01.920190 (MainThread): Partial parsing not enabled
2021-06-06 03:49:01.921147 (MainThread): Parsing macros/catalog.sql
2021-06-06 03:49:01.923235 (MainThread): Parsing macros/adapters.sql
2021-06-06 03:49:01.946044 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 03:49:01.947525 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 03:49:01.948598 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 03:49:01.951406 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 03:49:01.958655 (MainThread): Parsing macros/core.sql
2021-06-06 03:49:01.961509 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 03:49:01.967673 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 03:49:01.968879 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 03:49:01.980938 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 03:49:02.006691 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 03:49:02.021520 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 03:49:02.022726 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 03:49:02.026857 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 03:49:02.036912 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 03:49:02.041798 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 03:49:02.046249 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 03:49:02.049695 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 03:49:02.050308 (MainThread): Parsing macros/etc/query.sql
2021-06-06 03:49:02.051105 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 03:49:02.052194 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 03:49:02.058280 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 03:49:02.059575 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 03:49:02.060685 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 03:49:02.091255 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 03:49:02.092473 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 03:49:02.093446 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 03:49:02.094538 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 03:49:02.099649 (MainThread): Partial parsing not enabled
2021-06-06 03:49:02.114560 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:49:02.185554 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 03:49:02.185719 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2421552f-32b7-4b32-ba76-47c235cb433b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59484a9a0>]}
2021-06-06 03:49:02.188206 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2421552f-32b7-4b32-ba76-47c235cb433b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff594b06730>]}
2021-06-06 03:49:02.188405 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-06 03:49:02.188812 (MainThread): 
2021-06-06 03:49:02.189004 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:49:02.189616 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 03:49:02.197319 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 03:49:02.197382 (ThreadPoolExecutor-0_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 03:49:02.197428 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 03:49:03.413242 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.22 seconds
2021-06-06 03:49:03.422058 (ThreadPoolExecutor-0_0): On list_test_dbt_public: Close
2021-06-06 03:49:03.709257 (MainThread): 11:49:03 | Concurrency: 1 threads (target='dev')
2021-06-06 03:49:03.709598 (MainThread): 11:49:03 | 
2021-06-06 03:49:03.711386 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 03:49:03.712859 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:49:03.713212 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 03:49:03.715761 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:49:03.716599 (Thread-1): finished collecting timing info
2021-06-06 03:49:03.716842 (Thread-1): finished collecting timing info
2021-06-06 03:49:03.717318 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 03:49:03.718487 (MainThread): Connection 'master' was properly closed.
2021-06-06 03:49:03.718639 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 03:49:03.723419 (MainThread): 11:49:03 | Done.
2021-06-06 03:49:03.728768 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-06-06 03:49:03.728954 (MainThread): 11:49:03 | Building catalog
2021-06-06 03:49:03.729469 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "test_dbt.information_schema".
2021-06-06 03:49:03.738458 (ThreadPoolExecutor-1_0): Using snowflake connection "test_dbt.information_schema".
2021-06-06 03:49:03.738684 (ThreadPoolExecutor-1_0): On test_dbt.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "test_dbt.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from test_dbt.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from test_dbt.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('public'))
      order by "column_index"
2021-06-06 03:49:03.738803 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 03:49:05.925602 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 2.19 seconds
2021-06-06 03:49:05.937057 (ThreadPoolExecutor-1_0): On test_dbt.information_schema: Close
2021-06-06 03:49:06.244778 (MainThread): 11:49:06 | Catalog written to /Users/ashsmith/Documents/dev/learn_dbt/target/catalog.json
2021-06-06 03:49:06.245071 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59316eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff594c60880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff594c60700>]}
2021-06-06 03:49:06.245347 (MainThread): Flushing usage events
2021-06-06 03:49:07.791997 (MainThread): Connection 'generate_catalog' was properly closed.
2021-06-06 03:49:07.792384 (MainThread): Connection 'test_dbt.information_schema' was properly closed.
2021-06-06 03:49:14.077260 (MainThread): Running with dbt=0.19.1
2021-06-06 03:49:14.490288 (MainThread): Loading KWallet
2021-06-06 03:49:14.490614 (MainThread): Loading SecretService
2021-06-06 03:49:14.490873 (MainThread): Loading Windows
2021-06-06 03:49:14.491192 (MainThread): Loading chainer
2021-06-06 03:49:14.491354 (MainThread): Loading macOS
2021-06-06 03:49:14.731447 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-06-06 03:49:14.740405 (MainThread): Tracking: tracking
2021-06-06 03:49:14.741144 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb91bb9a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb91bb9a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb91bbb7370>]}
2021-06-06 03:49:14.743750 (MainThread): Serving docs at 0.0.0.0:8080
2021-06-06 03:49:14.743893 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-06-06 03:49:14.743941 (MainThread): Press Ctrl+C to exit.


2021-06-06 03:52:24.350276 (MainThread): Flushing usage events
2021-06-06 03:52:26.005788 (MainThread): ctrl-c
2021-06-06 03:52:32.308050 (MainThread): Running with dbt=0.19.1
2021-06-06 03:52:32.858725 (MainThread): Loading KWallet
2021-06-06 03:52:32.859084 (MainThread): Loading SecretService
2021-06-06 03:52:32.859357 (MainThread): Loading Windows
2021-06-06 03:52:32.859714 (MainThread): Loading chainer
2021-06-06 03:52:32.859891 (MainThread): Loading macOS
2021-06-06 03:52:33.118033 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 03:52:33.119215 (MainThread): Tracking: tracking
2021-06-06 03:52:33.119471 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47314dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa473e299a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa473e29a00>]}
2021-06-06 03:52:33.126706 (MainThread): Partial parsing not enabled
2021-06-06 03:52:33.127484 (MainThread): Parsing macros/catalog.sql
2021-06-06 03:52:33.129403 (MainThread): Parsing macros/adapters.sql
2021-06-06 03:52:33.152403 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 03:52:33.153878 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 03:52:33.154876 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 03:52:33.157621 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 03:52:33.164846 (MainThread): Parsing macros/core.sql
2021-06-06 03:52:33.167661 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 03:52:33.173915 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 03:52:33.175174 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 03:52:33.187531 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 03:52:33.214587 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 03:52:33.230019 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 03:52:33.231292 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 03:52:33.235509 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 03:52:33.246093 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 03:52:33.251283 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 03:52:33.255959 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 03:52:33.259478 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 03:52:33.260095 (MainThread): Parsing macros/etc/query.sql
2021-06-06 03:52:33.260897 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 03:52:33.261985 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 03:52:33.268305 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 03:52:33.269626 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 03:52:33.270736 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 03:52:33.302804 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 03:52:33.304090 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 03:52:33.305073 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 03:52:33.306189 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 03:52:33.311338 (MainThread): Partial parsing not enabled
2021-06-06 03:52:33.326498 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:52:33.407004 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 03:52:33.407188 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5360f29b-0e75-4525-a818-ea44f95f9467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47482a1c0>]}
2021-06-06 03:52:33.410216 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5360f29b-0e75-4525-a818-ea44f95f9467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4748eeee0>]}
2021-06-06 03:52:33.410412 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-06 03:52:33.410850 (MainThread): 
2021-06-06 03:52:33.411080 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:52:33.411661 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-06 03:52:33.419741 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-06 03:52:33.419831 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-06 03:52:33.419880 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 03:52:34.701970 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.28 seconds
2021-06-06 03:52:34.710056 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-06 03:52:34.980646 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 03:52:34.992653 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 03:52:34.992811 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 03:52:34.992925 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 03:52:36.171350 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.18 seconds
2021-06-06 03:52:36.175249 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-06 03:52:36.462336 (MainThread): Using snowflake connection "master".
2021-06-06 03:52:36.462540 (MainThread): On master: BEGIN
2021-06-06 03:52:36.462674 (MainThread): Opening a new connection, currently in state init
2021-06-06 03:52:37.424456 (MainThread): SQL status: SUCCESS 1 in 0.96 seconds
2021-06-06 03:52:37.425429 (MainThread): On master: COMMIT
2021-06-06 03:52:37.425984 (MainThread): Using snowflake connection "master".
2021-06-06 03:52:37.426237 (MainThread): On master: COMMIT
2021-06-06 03:52:37.744169 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-06-06 03:52:37.745085 (MainThread): On master: Close
2021-06-06 03:52:38.025136 (MainThread): 11:52:38 | Concurrency: 1 threads (target='dev')
2021-06-06 03:52:38.025492 (MainThread): 11:52:38 | 
2021-06-06 03:52:38.027586 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 03:52:38.028027 (Thread-1): 11:52:38 | 1 of 1 START view model public.customer_orders....................... [RUN]
2021-06-06 03:52:38.028467 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:52:38.028632 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 03:52:38.031208 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:52:38.032422 (Thread-1): finished collecting timing info
2021-06-06 03:52:38.066200 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:52:38.069090 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:52:38.069170 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-06 03:52:38.069247 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 03:52:38.945870 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-06-06 03:52:38.946482 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:52:38.946631 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with cte_customer as (
  
  select 
    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
  FROM test_raw.public.customers
  ), 
  
  cte_orders as (
  select 
    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
    from test_raw.public.orders
  ),
  cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from cte_orders
    group by 1
  ),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from cte_orders
    inner join cte_customer_orders on cte_orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-06 03:52:39.361800 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-06-06 03:52:39.365402 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 03:52:39.365811 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:52:39.365953 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 03:52:39.599383 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-06-06 03:52:39.614406 (Thread-1): finished collecting timing info
2021-06-06 03:52:39.614680 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-06 03:52:39.896020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5360f29b-0e75-4525-a818-ea44f95f9467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4748f7ac0>]}
2021-06-06 03:52:39.896721 (Thread-1): 11:52:39 | 1 of 1 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.87s]
2021-06-06 03:52:39.897006 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 03:52:39.899892 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:52:39.900202 (MainThread): Using snowflake connection "master".
2021-06-06 03:52:39.900324 (MainThread): On master: BEGIN
2021-06-06 03:52:39.900444 (MainThread): Opening a new connection, currently in state closed
2021-06-06 03:52:40.889395 (MainThread): SQL status: SUCCESS 1 in 0.99 seconds
2021-06-06 03:52:40.890335 (MainThread): On master: COMMIT
2021-06-06 03:52:40.890901 (MainThread): Using snowflake connection "master".
2021-06-06 03:52:40.891174 (MainThread): On master: COMMIT
2021-06-06 03:52:41.153481 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-06-06 03:52:41.154388 (MainThread): On master: Close
2021-06-06 03:52:41.451971 (MainThread): 11:52:41 | 
2021-06-06 03:52:41.452379 (MainThread): 11:52:41 | Finished running 1 view model in 8.04s.
2021-06-06 03:52:41.452558 (MainThread): Connection 'master' was properly closed.
2021-06-06 03:52:41.452653 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 03:52:41.459801 (MainThread): 
2021-06-06 03:52:41.460017 (MainThread): Completed successfully
2021-06-06 03:52:41.460213 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-06 03:52:41.460437 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa474c2aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa474c2a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa474c2a8b0>]}
2021-06-06 03:52:41.460688 (MainThread): Flushing usage events
2021-06-06 03:55:02.805081 (MainThread): Running with dbt=0.19.1
2021-06-06 03:55:03.379746 (MainThread): Loading KWallet
2021-06-06 03:55:03.380153 (MainThread): Loading SecretService
2021-06-06 03:55:03.380429 (MainThread): Loading Windows
2021-06-06 03:55:03.380810 (MainThread): Loading chainer
2021-06-06 03:55:03.381027 (MainThread): Loading macOS
2021-06-06 03:55:03.655038 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-06-06 03:55:03.656419 (MainThread): Tracking: tracking
2021-06-06 03:55:03.656659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dafcdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dbc9a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dbc9aa30>]}
2021-06-06 03:55:03.664159 (MainThread): Partial parsing not enabled
2021-06-06 03:55:03.664945 (MainThread): Parsing macros/catalog.sql
2021-06-06 03:55:03.666809 (MainThread): Parsing macros/adapters.sql
2021-06-06 03:55:03.689489 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 03:55:03.690950 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 03:55:03.691964 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 03:55:03.694702 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 03:55:03.701883 (MainThread): Parsing macros/core.sql
2021-06-06 03:55:03.704628 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 03:55:03.710794 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 03:55:03.712011 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 03:55:03.724380 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 03:55:03.751236 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 03:55:03.766584 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 03:55:03.767847 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 03:55:03.772099 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 03:55:03.782503 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 03:55:03.787514 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 03:55:03.792109 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 03:55:03.795609 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 03:55:03.796229 (MainThread): Parsing macros/etc/query.sql
2021-06-06 03:55:03.797018 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 03:55:03.798108 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 03:55:03.804392 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 03:55:03.805727 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 03:55:03.806850 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 03:55:03.838747 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 03:55:03.839985 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 03:55:03.840983 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 03:55:03.842103 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 03:55:03.847309 (MainThread): Partial parsing not enabled
2021-06-06 03:55:03.862027 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:55:03.945742 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 03:55:03.945927 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa94ce9e-f072-4583-a857-dac98b059bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dc60f9a0>]}
2021-06-06 03:55:03.951066 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa94ce9e-f072-4583-a857-dac98b059bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dc63bdc0>]}
2021-06-06 03:55:03.951284 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-06 03:55:03.951749 (MainThread): 
2021-06-06 03:55:03.951957 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 03:55:03.952489 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 03:55:03.960315 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 03:55:03.960394 (ThreadPoolExecutor-0_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 03:55:03.960440 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 03:55:05.240423 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.28 seconds
2021-06-06 03:55:05.249556 (ThreadPoolExecutor-0_0): On list_test_dbt_public: Close
2021-06-06 03:55:05.517948 (MainThread): 11:55:05 | Concurrency: 1 threads (target='dev')
2021-06-06 03:55:05.518248 (MainThread): 11:55:05 | 
2021-06-06 03:55:05.520144 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 03:55:05.521294 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 03:55:05.521522 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 03:55:05.526474 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 03:55:05.529358 (Thread-1): finished collecting timing info
2021-06-06 03:55:05.529563 (Thread-1): finished collecting timing info
2021-06-06 03:55:05.529956 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 03:55:05.531026 (MainThread): Connection 'master' was properly closed.
2021-06-06 03:55:05.531157 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 03:55:05.537018 (MainThread): 11:55:05 | Done.
2021-06-06 03:55:05.540928 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-06-06 03:55:05.541083 (MainThread): 11:55:05 | Building catalog
2021-06-06 03:55:05.542335 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "test_dbt.information_schema".
2021-06-06 03:55:05.552393 (ThreadPoolExecutor-1_0): Using snowflake connection "test_dbt.information_schema".
2021-06-06 03:55:05.552556 (ThreadPoolExecutor-1_0): On test_dbt.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "test_dbt.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from test_dbt.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from test_dbt.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('public'))
      order by "column_index"
2021-06-06 03:55:05.552651 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 03:55:08.013595 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 2.46 seconds
2021-06-06 03:55:08.025444 (ThreadPoolExecutor-1_0): On test_dbt.information_schema: Close
2021-06-06 03:55:08.336404 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "test_raw.information_schema".
2021-06-06 03:55:08.342965 (ThreadPoolExecutor-1_0): Using snowflake connection "test_raw.information_schema".
2021-06-06 03:55:08.343152 (ThreadPoolExecutor-1_0): On test_raw.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "test_raw.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from test_raw.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from test_raw.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('public'))
      order by "column_index"
2021-06-06 03:55:08.343308 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 03:55:10.594646 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 29 in 2.25 seconds
2021-06-06 03:55:10.610714 (ThreadPoolExecutor-1_0): On test_raw.information_schema: Close
2021-06-06 03:55:10.903866 (MainThread): 11:55:10 | Catalog written to /Users/ashsmith/Documents/dev/learn_dbt/target/catalog.json
2021-06-06 03:55:10.904174 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dafcdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dc88aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0dc89b910>]}
2021-06-06 03:55:10.904406 (MainThread): Flushing usage events
2021-06-06 03:55:12.460420 (MainThread): Connection 'generate_catalog' was properly closed.
2021-06-06 03:55:12.460699 (MainThread): Connection 'test_raw.information_schema' was properly closed.
2021-06-06 03:55:16.533015 (MainThread): Running with dbt=0.19.1
2021-06-06 03:55:16.889463 (MainThread): Loading KWallet
2021-06-06 03:55:16.889774 (MainThread): Loading SecretService
2021-06-06 03:55:16.890012 (MainThread): Loading Windows
2021-06-06 03:55:16.890334 (MainThread): Loading chainer
2021-06-06 03:55:16.890481 (MainThread): Loading macOS
2021-06-06 03:55:17.093411 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-06-06 03:55:17.095707 (MainThread): Tracking: tracking
2021-06-06 03:55:17.096280 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bab962a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bab9628e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bab97f070>]}
2021-06-06 03:55:17.097675 (MainThread): Serving docs at 0.0.0.0:8080
2021-06-06 03:55:17.097755 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-06-06 03:55:17.097794 (MainThread): Press Ctrl+C to exit.


2021-06-06 04:55:50.471601 (MainThread): Flushing usage events
2021-06-06 04:55:52.402122 (MainThread): ctrl-c
2021-06-06 04:56:10.835109 (MainThread): Running with dbt=0.19.1
2021-06-06 04:56:11.350459 (MainThread): Loading KWallet
2021-06-06 04:56:11.350817 (MainThread): Loading SecretService
2021-06-06 04:56:11.351087 (MainThread): Loading Windows
2021-06-06 04:56:11.351436 (MainThread): Loading chainer
2021-06-06 04:56:11.351609 (MainThread): Loading macOS
2021-06-06 04:56:11.610465 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-06 04:56:11.611897 (MainThread): Tracking: tracking
2021-06-06 04:56:11.612134 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccb12dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd85ccb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd85cce20>]}
2021-06-06 04:56:11.619469 (MainThread): Partial parsing not enabled
2021-06-06 04:56:11.620380 (MainThread): Parsing macros/catalog.sql
2021-06-06 04:56:11.622320 (MainThread): Parsing macros/adapters.sql
2021-06-06 04:56:11.645992 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 04:56:11.647465 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 04:56:11.648470 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 04:56:11.651302 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 04:56:11.658788 (MainThread): Parsing macros/core.sql
2021-06-06 04:56:11.661594 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 04:56:11.667875 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 04:56:11.669084 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 04:56:11.681515 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 04:56:11.709396 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 04:56:11.724997 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 04:56:11.726243 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 04:56:11.730467 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 04:56:11.741299 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 04:56:11.746399 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 04:56:11.751029 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 04:56:11.754555 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 04:56:11.755174 (MainThread): Parsing macros/etc/query.sql
2021-06-06 04:56:11.755953 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 04:56:11.757045 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 04:56:11.763375 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 04:56:11.764694 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 04:56:11.765799 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 04:56:11.798653 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 04:56:11.799897 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 04:56:11.800864 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 04:56:11.801983 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 04:56:11.807150 (MainThread): Partial parsing not enabled
2021-06-06 04:56:11.822142 (MainThread): Acquiring new snowflake connection "model.my_new_project.orders".
2021-06-06 04:56:11.828349 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 04:56:11.908016 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 04:56:11.908320 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e99ea75d-5df8-4b51-aaab-7b2c7c7ae52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccc799a30>]}
2021-06-06 04:56:11.911398 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e99ea75d-5df8-4b51-aaab-7b2c7c7ae52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccc79f940>]}
2021-06-06 04:56:11.911592 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-06 04:56:11.911981 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-06-06 04:56:11.912097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccc7a80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccc842d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccc842eb0>]}
2021-06-06 04:56:11.912187 (MainThread): Flushing usage events
2021-06-06 04:56:13.424076 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 05:03:08.372864 (MainThread): Running with dbt=0.19.1
2021-06-06 05:03:08.934046 (MainThread): Loading KWallet
2021-06-06 05:03:08.934423 (MainThread): Loading SecretService
2021-06-06 05:03:08.934700 (MainThread): Loading Windows
2021-06-06 05:03:08.935057 (MainThread): Loading chainer
2021-06-06 05:03:08.935234 (MainThread): Loading macOS
2021-06-06 05:03:09.204582 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 05:03:09.205827 (MainThread): Tracking: tracking
2021-06-06 05:03:09.206083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a931ddb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a93e929a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a93e92a00>]}
2021-06-06 05:03:09.213739 (MainThread): Partial parsing not enabled
2021-06-06 05:03:09.214645 (MainThread): Parsing macros/catalog.sql
2021-06-06 05:03:09.216616 (MainThread): Parsing macros/adapters.sql
2021-06-06 05:03:09.240661 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 05:03:09.242189 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 05:03:09.243241 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 05:03:09.246185 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 05:03:09.253932 (MainThread): Parsing macros/core.sql
2021-06-06 05:03:09.256793 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 05:03:09.263345 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 05:03:09.264651 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 05:03:09.277294 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 05:03:09.304436 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 05:03:09.319923 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 05:03:09.321186 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 05:03:09.325490 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 05:03:09.336028 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 05:03:09.341122 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 05:03:09.345748 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 05:03:09.349292 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 05:03:09.349941 (MainThread): Parsing macros/etc/query.sql
2021-06-06 05:03:09.350756 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 05:03:09.351862 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 05:03:09.358226 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 05:03:09.359619 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 05:03:09.360741 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 05:03:09.392940 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 05:03:09.394196 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 05:03:09.395175 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 05:03:09.396293 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 05:03:09.401515 (MainThread): Partial parsing not enabled
2021-06-06 05:03:09.417096 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:03:09.424320 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:03:09.426736 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:03:09.505584 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 05:03:09.505911 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e0842cd-8adb-436f-a755-373902f08804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a94867190>]}
2021-06-06 05:03:09.509278 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e0842cd-8adb-436f-a755-373902f08804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a803908b0>]}
2021-06-06 05:03:09.509465 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-06 05:03:09.509933 (MainThread): 
2021-06-06 05:03:09.510116 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 05:03:09.510734 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-06 05:03:09.518655 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-06 05:03:09.518716 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-06 05:03:09.518761 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 05:03:10.776872 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.26 seconds
2021-06-06 05:03:10.786501 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-06 05:03:11.068590 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 05:03:11.080335 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 05:03:11.080506 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 05:03:11.080621 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 05:03:11.937067 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.86 seconds
2021-06-06 05:03:11.940159 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-06 05:03:12.211285 (MainThread): Using snowflake connection "master".
2021-06-06 05:03:12.211504 (MainThread): On master: BEGIN
2021-06-06 05:03:12.211636 (MainThread): Opening a new connection, currently in state init
2021-06-06 05:03:13.123606 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-06-06 05:03:13.124395 (MainThread): On master: COMMIT
2021-06-06 05:03:13.124825 (MainThread): Using snowflake connection "master".
2021-06-06 05:03:13.125003 (MainThread): On master: COMMIT
2021-06-06 05:03:13.378507 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-06-06 05:03:13.379434 (MainThread): On master: Close
2021-06-06 05:03:13.647348 (MainThread): 13:03:13 | Concurrency: 1 threads (target='dev')
2021-06-06 05:03:13.647683 (MainThread): 13:03:13 | 
2021-06-06 05:03:13.649624 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-06 05:03:13.650077 (Thread-1): 13:03:13 | 1 of 3 START view model public.stg_customers......................... [RUN]
2021-06-06 05:03:13.650535 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:03:13.650699 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-06 05:03:13.655224 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-06 05:03:13.656972 (Thread-1): finished collecting timing info
2021-06-06 05:03:13.687288 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-06-06 05:03:13.688586 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:03:13.688671 (Thread-1): On model.my_new_project.stg_customers: BEGIN
2021-06-06 05:03:13.688740 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 05:03:14.557917 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-06-06 05:03:14.558616 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:03:14.558840 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view test_dbt.public.stg_customers  as (
    with 

source as (

    select * from test_raw.public.customers

),

cleaned as (
    
    select

    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
            
    from source

)

select * from cleaned
  );
2021-06-06 05:03:14.892469 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-06-06 05:03:14.895652 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-06 05:03:14.896155 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:03:14.896362 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-06 05:03:15.051307 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-06-06 05:03:15.066064 (Thread-1): finished collecting timing info
2021-06-06 05:03:15.066435 (Thread-1): On model.my_new_project.stg_customers: Close
2021-06-06 05:03:15.339387 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0842cd-8adb-436f-a755-373902f08804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a94bd5ee0>]}
2021-06-06 05:03:15.339952 (Thread-1): 13:03:15 | 1 of 3 OK created view model public.stg_customers.................... [SUCCESS 1 in 1.69s]
2021-06-06 05:03:15.340163 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-06 05:03:15.340368 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-06 05:03:15.341363 (Thread-1): 13:03:15 | 2 of 3 START view model public.stg_orders............................ [RUN]
2021-06-06 05:03:15.341775 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:03:15.341922 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-06 05:03:15.346267 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-06 05:03:15.346970 (Thread-1): finished collecting timing info
2021-06-06 05:03:15.349370 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-06-06 05:03:15.350807 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:03:15.350918 (Thread-1): On model.my_new_project.stg_orders: BEGIN
2021-06-06 05:03:15.351016 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 05:03:16.182713 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-06-06 05:03:16.183395 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:03:16.183576 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view test_dbt.public.stg_orders  as (
    with 

source as (

    select * from test_raw.public.orders

),

cleaned as (
    
    select

    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
            
    from source

)

select * from cleaned
  );
2021-06-06 05:03:16.556865 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-06-06 05:03:16.561323 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-06 05:03:16.561881 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:03:16.562129 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-06 05:03:16.731273 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-06 05:03:16.734841 (Thread-1): finished collecting timing info
2021-06-06 05:03:16.735404 (Thread-1): On model.my_new_project.stg_orders: Close
2021-06-06 05:03:17.038086 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0842cd-8adb-436f-a755-373902f08804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a94bd5250>]}
2021-06-06 05:03:17.038761 (Thread-1): 13:03:17 | 2 of 3 OK created view model public.stg_orders....................... [SUCCESS 1 in 1.70s]
2021-06-06 05:03:17.038983 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-06 05:03:17.040270 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 05:03:17.040911 (Thread-1): 13:03:17 | 3 of 3 START view model public.customer_orders....................... [RUN]
2021-06-06 05:03:17.041551 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:03:17.041717 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 05:03:17.046725 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 05:03:17.047716 (Thread-1): finished collecting timing info
2021-06-06 05:03:17.050163 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-06 05:03:17.052688 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:03:17.052800 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-06 05:03:17.052905 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 05:03:17.946956 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-06-06 05:03:17.947665 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:03:17.947821 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with 

customers as (
    select * from test_dbt.public.stg_customers
),

orders as (
    select * from test_dbt.public.stg_orders
),

cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from customers
    group by 1
),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from orders
    inner join cte_customer_orders on orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-06 05:03:18.229637 (Thread-1): Snowflake query id: 019cbd2f-3200-4d88-0000-000065a95179
2021-06-06 05:03:18.230351 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 8
invalid identifier 'ORDER_DATE'
2021-06-06 05:03:18.231110 (Thread-1): finished collecting timing info
2021-06-06 05:03:18.231508 (Thread-1): On model.my_new_project.customer_orders: ROLLBACK
2021-06-06 05:03:18.505451 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-06 05:03:18.783112 (Thread-1): Database Error in model customer_orders (models/marts/orders/customer_orders.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'ORDER_DATE'
  compiled SQL at target/run/my_new_project/models/marts/orders/customer_orders.sql
Traceback (most recent call last):
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 15 at position 8
invalid identifier 'ORDER_DATE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/orders/customer_orders.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'ORDER_DATE'
  compiled SQL at target/run/my_new_project/models/marts/orders/customer_orders.sql
2021-06-06 05:03:18.792546 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0842cd-8adb-436f-a755-373902f08804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8048af10>]}
2021-06-06 05:03:18.793102 (Thread-1): 13:03:18 | 3 of 3 ERROR creating view model public.customer_orders.............. [ERROR in 1.75s]
2021-06-06 05:03:18.793327 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 05:03:18.794943 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 05:03:18.795205 (MainThread): Using snowflake connection "master".
2021-06-06 05:03:18.795302 (MainThread): On master: BEGIN
2021-06-06 05:03:18.795396 (MainThread): Opening a new connection, currently in state closed
2021-06-06 05:03:19.662068 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-06-06 05:03:19.663008 (MainThread): On master: COMMIT
2021-06-06 05:03:19.663662 (MainThread): Using snowflake connection "master".
2021-06-06 05:03:19.664008 (MainThread): On master: COMMIT
2021-06-06 05:03:19.916505 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-06-06 05:03:19.917227 (MainThread): On master: Close
2021-06-06 05:03:20.214857 (MainThread): 13:03:20 | 
2021-06-06 05:03:20.215204 (MainThread): 13:03:20 | Finished running 3 view models in 10.70s.
2021-06-06 05:03:20.215367 (MainThread): Connection 'master' was properly closed.
2021-06-06 05:03:20.215477 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 05:03:20.223793 (MainThread): 
2021-06-06 05:03:20.224032 (MainThread): Completed with 1 error and 0 warnings:
2021-06-06 05:03:20.224178 (MainThread): 
2021-06-06 05:03:20.224315 (MainThread): Database Error in model customer_orders (models/marts/orders/customer_orders.sql)
2021-06-06 05:03:20.224439 (MainThread):   000904 (42000): SQL compilation error: error line 15 at position 8
2021-06-06 05:03:20.224553 (MainThread):   invalid identifier 'ORDER_DATE'
2021-06-06 05:03:20.224667 (MainThread):   compiled SQL at target/run/my_new_project/models/marts/orders/customer_orders.sql
2021-06-06 05:03:20.224796 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-06-06 05:03:20.225021 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a949a1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8048a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8048ad30>]}
2021-06-06 05:03:20.225275 (MainThread): Flushing usage events
2021-06-06 05:04:09.825767 (MainThread): Running with dbt=0.19.1
2021-06-06 05:04:10.271528 (MainThread): Loading KWallet
2021-06-06 05:04:10.271911 (MainThread): Loading SecretService
2021-06-06 05:04:10.272208 (MainThread): Loading Windows
2021-06-06 05:04:10.272570 (MainThread): Loading chainer
2021-06-06 05:04:10.272741 (MainThread): Loading macOS
2021-06-06 05:04:10.529625 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 05:04:10.530943 (MainThread): Tracking: tracking
2021-06-06 05:04:10.531171 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb2fb5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb3c54ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb3c54d00>]}
2021-06-06 05:04:10.538238 (MainThread): Partial parsing not enabled
2021-06-06 05:04:10.539012 (MainThread): Parsing macros/catalog.sql
2021-06-06 05:04:10.540863 (MainThread): Parsing macros/adapters.sql
2021-06-06 05:04:10.563559 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 05:04:10.565059 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 05:04:10.566084 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 05:04:10.568935 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 05:04:10.576453 (MainThread): Parsing macros/core.sql
2021-06-06 05:04:10.579362 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 05:04:10.585531 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 05:04:10.586751 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 05:04:10.599050 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 05:04:10.625120 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 05:04:10.640045 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 05:04:10.641297 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 05:04:10.645472 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 05:04:10.655685 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 05:04:10.660637 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 05:04:10.665178 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 05:04:10.668618 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 05:04:10.669245 (MainThread): Parsing macros/etc/query.sql
2021-06-06 05:04:10.670028 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 05:04:10.671133 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 05:04:10.677281 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 05:04:10.678603 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 05:04:10.679706 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 05:04:10.710566 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 05:04:10.711808 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 05:04:10.712789 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 05:04:10.713908 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 05:04:10.719054 (MainThread): Partial parsing not enabled
2021-06-06 05:04:10.733950 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:04:10.740206 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:04:10.742304 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:04:10.820057 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 05:04:10.820369 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a748c1e-b9a7-41bc-b6c6-c0bb2de79065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb45f5d30>]}
2021-06-06 05:04:10.823523 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a748c1e-b9a7-41bc-b6c6-c0bb2de79065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa08a1730>]}
2021-06-06 05:04:10.823704 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-06 05:04:10.824211 (MainThread): 
2021-06-06 05:04:10.824422 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 05:04:10.825036 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-06 05:04:10.832917 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-06 05:04:10.832976 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-06 05:04:10.833019 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 05:04:12.126273 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.29 seconds
2021-06-06 05:04:12.134543 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-06 05:04:12.419476 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 05:04:12.430215 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 05:04:12.430374 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 05:04:12.430485 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 05:04:13.452125 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.02 seconds
2021-06-06 05:04:13.455186 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-06 05:04:13.735725 (MainThread): Using snowflake connection "master".
2021-06-06 05:04:13.735948 (MainThread): On master: BEGIN
2021-06-06 05:04:13.736082 (MainThread): Opening a new connection, currently in state init
2021-06-06 05:04:14.638520 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-06-06 05:04:14.639482 (MainThread): On master: COMMIT
2021-06-06 05:04:14.640003 (MainThread): Using snowflake connection "master".
2021-06-06 05:04:14.640147 (MainThread): On master: COMMIT
2021-06-06 05:04:14.892557 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-06-06 05:04:14.893292 (MainThread): On master: Close
2021-06-06 05:04:15.179305 (MainThread): 13:04:15 | Concurrency: 1 threads (target='dev')
2021-06-06 05:04:15.179717 (MainThread): 13:04:15 | 
2021-06-06 05:04:15.181727 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-06 05:04:15.182200 (Thread-1): 13:04:15 | 1 of 3 START view model public.stg_customers......................... [RUN]
2021-06-06 05:04:15.182672 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:04:15.182846 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-06 05:04:15.187272 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-06 05:04:15.187963 (Thread-1): finished collecting timing info
2021-06-06 05:04:15.211494 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-06-06 05:04:15.212839 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:04:15.212935 (Thread-1): On model.my_new_project.stg_customers: BEGIN
2021-06-06 05:04:15.213014 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 05:04:16.311685 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-06-06 05:04:16.312463 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:04:16.312654 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view test_dbt.public.stg_customers  as (
    with 

source as (

    select * from test_raw.public.customers

),

cleaned as (
    
    select

    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
            
    from source

)

select * from cleaned
  );
2021-06-06 05:04:16.724786 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-06-06 05:04:16.728245 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-06 05:04:16.728718 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:04:16.728952 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-06 05:04:16.887235 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-06-06 05:04:16.898716 (Thread-1): finished collecting timing info
2021-06-06 05:04:16.898900 (Thread-1): On model.my_new_project.stg_customers: Close
2021-06-06 05:04:17.190927 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a748c1e-b9a7-41bc-b6c6-c0bb2de79065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb48b7640>]}
2021-06-06 05:04:17.191585 (Thread-1): 13:04:17 | 1 of 3 OK created view model public.stg_customers.................... [SUCCESS 1 in 2.01s]
2021-06-06 05:04:17.191810 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-06 05:04:17.192029 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-06 05:04:17.192305 (Thread-1): 13:04:17 | 2 of 3 START view model public.stg_orders............................ [RUN]
2021-06-06 05:04:17.193413 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:04:17.193638 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-06 05:04:17.198105 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-06 05:04:17.198815 (Thread-1): finished collecting timing info
2021-06-06 05:04:17.201694 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-06-06 05:04:17.203151 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:04:17.203260 (Thread-1): On model.my_new_project.stg_orders: BEGIN
2021-06-06 05:04:17.203360 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 05:04:18.097912 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-06-06 05:04:18.098725 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:04:18.098977 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view test_dbt.public.stg_orders  as (
    with 

source as (

    select * from test_raw.public.orders

),

cleaned as (
    
    select

    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
            
    from source

)

select * from cleaned
  );
2021-06-06 05:04:18.466028 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-06-06 05:04:18.469342 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-06 05:04:18.469698 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:04:18.469817 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-06 05:04:18.637587 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-06 05:04:18.640555 (Thread-1): finished collecting timing info
2021-06-06 05:04:18.640923 (Thread-1): On model.my_new_project.stg_orders: Close
2021-06-06 05:04:18.921307 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a748c1e-b9a7-41bc-b6c6-c0bb2de79065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb48b7430>]}
2021-06-06 05:04:18.922278 (Thread-1): 13:04:18 | 2 of 3 OK created view model public.stg_orders....................... [SUCCESS 1 in 1.73s]
2021-06-06 05:04:18.922599 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-06 05:04:18.924295 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 05:04:18.924773 (Thread-1): 13:04:18 | 3 of 3 START view model public.customer_orders....................... [RUN]
2021-06-06 05:04:18.925236 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:04:18.925396 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 05:04:18.930579 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 05:04:18.931267 (Thread-1): finished collecting timing info
2021-06-06 05:04:18.934058 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-06 05:04:18.936231 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:04:18.936344 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-06 05:04:18.936450 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 05:04:19.782789 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-06-06 05:04:19.783574 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:04:19.783765 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with 

customers as (
    select * from test_dbt.public.stg_customers
),

orders as (
    select * from test_dbt.public.stg_orders
),

cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from orders
    group by 1
),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from orders
    inner join cte_customer_orders on orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-06 05:04:20.182231 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-06-06 05:04:20.186139 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 05:04:20.186574 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:04:20.186754 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 05:04:20.465338 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-06-06 05:04:20.467778 (Thread-1): finished collecting timing info
2021-06-06 05:04:20.468195 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-06 05:04:20.763621 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a748c1e-b9a7-41bc-b6c6-c0bb2de79065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9008bbe0>]}
2021-06-06 05:04:20.764375 (Thread-1): 13:04:20 | 3 of 3 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.84s]
2021-06-06 05:04:20.764645 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 05:04:20.766461 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 05:04:20.766789 (MainThread): Using snowflake connection "master".
2021-06-06 05:04:20.766923 (MainThread): On master: BEGIN
2021-06-06 05:04:20.767049 (MainThread): Opening a new connection, currently in state closed
2021-06-06 05:04:21.631970 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-06-06 05:04:21.632947 (MainThread): On master: COMMIT
2021-06-06 05:04:21.633427 (MainThread): Using snowflake connection "master".
2021-06-06 05:04:21.633617 (MainThread): On master: COMMIT
2021-06-06 05:04:21.877231 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-06-06 05:04:21.878049 (MainThread): On master: Close
2021-06-06 05:04:22.157849 (MainThread): 13:04:22 | 
2021-06-06 05:04:22.158145 (MainThread): 13:04:22 | Finished running 3 view models in 11.33s.
2021-06-06 05:04:22.158311 (MainThread): Connection 'master' was properly closed.
2021-06-06 05:04:22.158421 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 05:04:22.165288 (MainThread): 
2021-06-06 05:04:22.165562 (MainThread): Completed successfully
2021-06-06 05:04:22.165738 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-06 05:04:22.165985 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f90094520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f90094970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f90094f70>]}
2021-06-06 05:04:22.166289 (MainThread): Flushing usage events
2021-06-06 05:04:38.151912 (MainThread): Running with dbt=0.19.1
2021-06-06 05:04:38.573900 (MainThread): Loading KWallet
2021-06-06 05:04:38.574268 (MainThread): Loading SecretService
2021-06-06 05:04:38.574542 (MainThread): Loading Windows
2021-06-06 05:04:38.574888 (MainThread): Loading chainer
2021-06-06 05:04:38.575062 (MainThread): Loading macOS
2021-06-06 05:04:38.820896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-06-06 05:04:38.821935 (MainThread): Tracking: tracking
2021-06-06 05:04:38.822184 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd535a5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd542429d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd54242a30>]}
2021-06-06 05:04:38.828876 (MainThread): Partial parsing not enabled
2021-06-06 05:04:38.829855 (MainThread): Parsing macros/catalog.sql
2021-06-06 05:04:38.831769 (MainThread): Parsing macros/adapters.sql
2021-06-06 05:04:38.855136 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 05:04:38.856692 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 05:04:38.857752 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 05:04:38.860666 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 05:04:38.868265 (MainThread): Parsing macros/core.sql
2021-06-06 05:04:38.871102 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 05:04:38.877403 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 05:04:38.878645 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 05:04:38.891062 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 05:04:38.918872 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 05:04:38.934518 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 05:04:38.935764 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 05:04:38.940007 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 05:04:38.950727 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 05:04:38.955843 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 05:04:38.960462 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 05:04:38.963979 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 05:04:38.964606 (MainThread): Parsing macros/etc/query.sql
2021-06-06 05:04:38.965418 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 05:04:38.966549 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 05:04:38.972894 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 05:04:38.974240 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 05:04:38.975354 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 05:04:39.008247 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 05:04:39.009495 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 05:04:39.010472 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 05:04:39.011591 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 05:04:39.016777 (MainThread): Partial parsing not enabled
2021-06-06 05:04:39.031667 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:04:39.037974 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:04:39.040109 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:04:39.117617 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 05:04:39.117936 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea83cbbe-f542-4da2-be54-9a065c002c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd54b7d220>]}
2021-06-06 05:04:39.121083 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea83cbbe-f542-4da2-be54-9a065c002c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd54b6d5b0>]}
2021-06-06 05:04:39.121249 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-06 05:04:39.121724 (MainThread): 
2021-06-06 05:04:39.121907 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 05:04:39.122471 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 05:04:39.130127 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 05:04:39.130192 (ThreadPoolExecutor-0_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 05:04:39.130240 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 05:04:40.405373 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.27 seconds
2021-06-06 05:04:40.415083 (ThreadPoolExecutor-0_0): On list_test_dbt_public: Close
2021-06-06 05:04:40.689345 (MainThread): 13:04:40 | Concurrency: 1 threads (target='dev')
2021-06-06 05:04:40.689620 (MainThread): 13:04:40 | 
2021-06-06 05:04:40.692007 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-06 05:04:40.692528 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 05:04:40.692701 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-06 05:04:40.696949 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-06 05:04:40.697759 (Thread-1): finished collecting timing info
2021-06-06 05:04:40.697988 (Thread-1): finished collecting timing info
2021-06-06 05:04:40.698482 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-06 05:04:40.698672 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-06 05:04:40.699076 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 05:04:40.699203 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-06 05:04:40.702375 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-06 05:04:40.702779 (Thread-1): finished collecting timing info
2021-06-06 05:04:40.702933 (Thread-1): finished collecting timing info
2021-06-06 05:04:40.703248 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-06 05:04:40.703796 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 05:04:40.704185 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 05:04:40.704348 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 05:04:40.707508 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 05:04:40.707896 (Thread-1): finished collecting timing info
2021-06-06 05:04:40.708048 (Thread-1): finished collecting timing info
2021-06-06 05:04:40.708372 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 05:04:40.709162 (MainThread): Connection 'master' was properly closed.
2021-06-06 05:04:40.709280 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 05:04:40.713712 (MainThread): 13:04:40 | Done.
2021-06-06 05:04:40.716538 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-06-06 05:04:40.716625 (MainThread): 13:04:40 | Building catalog
2021-06-06 05:04:40.717511 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "test_dbt.information_schema".
2021-06-06 05:04:40.727368 (ThreadPoolExecutor-1_0): Using snowflake connection "test_dbt.information_schema".
2021-06-06 05:04:40.727545 (ThreadPoolExecutor-1_0): On test_dbt.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "test_dbt.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from test_dbt.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from test_dbt.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('public'))
      order by "column_index"
2021-06-06 05:04:40.727641 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-06 05:04:43.264964 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 14 in 2.54 seconds
2021-06-06 05:04:43.279222 (ThreadPoolExecutor-1_0): On test_dbt.information_schema: Close
2021-06-06 05:04:43.569267 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "test_raw.information_schema".
2021-06-06 05:04:43.576515 (ThreadPoolExecutor-1_0): Using snowflake connection "test_raw.information_schema".
2021-06-06 05:04:43.576705 (ThreadPoolExecutor-1_0): On test_raw.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "test_raw.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from test_raw.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from test_raw.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('public'))
      order by "column_index"
2021-06-06 05:04:43.576862 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 05:04:45.912090 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 29 in 2.34 seconds
2021-06-06 05:04:45.929457 (ThreadPoolExecutor-1_0): On test_raw.information_schema: Close
2021-06-06 05:04:46.231528 (MainThread): 13:04:46 | Catalog written to /Users/ashsmith/Documents/dev/learn_dbt/target/catalog.json
2021-06-06 05:04:46.231833 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd535a5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd54faaee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd54faa160>]}
2021-06-06 05:04:46.232063 (MainThread): Flushing usage events
2021-06-06 05:04:47.925437 (MainThread): Connection 'generate_catalog' was properly closed.
2021-06-06 05:04:47.925669 (MainThread): Connection 'test_raw.information_schema' was properly closed.
2021-06-06 05:04:52.794368 (MainThread): Running with dbt=0.19.1
2021-06-06 05:04:53.348369 (MainThread): Loading KWallet
2021-06-06 05:04:53.348740 (MainThread): Loading SecretService
2021-06-06 05:04:53.349014 (MainThread): Loading Windows
2021-06-06 05:04:53.349360 (MainThread): Loading chainer
2021-06-06 05:04:53.349534 (MainThread): Loading macOS
2021-06-06 05:04:53.598321 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-06-06 05:04:53.599243 (MainThread): Tracking: tracking
2021-06-06 05:04:53.599470 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae2cf6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae3a04d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae3a04820>]}
2021-06-06 05:04:53.601732 (MainThread): Serving docs at 0.0.0.0:8080
2021-06-06 05:04:53.601841 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-06-06 05:04:53.601887 (MainThread): Press Ctrl+C to exit.


2021-06-06 07:25:32.484759 (MainThread): Flushing usage events
2021-06-06 07:25:32.746612 (MainThread): ctrl-c
2021-06-06 07:25:32.748480 (MainThread): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.200.91', 63940)>
2021-06-06 07:25:36.554500 (MainThread): Running with dbt=0.19.1
2021-06-06 07:25:37.190174 (MainThread): Loading KWallet
2021-06-06 07:25:37.190597 (MainThread): Loading SecretService
2021-06-06 07:25:37.190975 (MainThread): Loading Windows
2021-06-06 07:25:37.191359 (MainThread): Loading chainer
2021-06-06 07:25:37.191558 (MainThread): Loading macOS
2021-06-06 07:25:37.476787 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='json', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 07:25:37.478813 (MainThread): Tracking: tracking
2021-06-06 07:25:37.479197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3b3e5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3c11c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3c11c9a0>]}
2021-06-06 07:25:37.487095 (MainThread): Partial parsing not enabled
2021-06-06 07:25:37.488143 (MainThread): Parsing macros/catalog.sql
2021-06-06 07:25:37.490161 (MainThread): Parsing macros/adapters.sql
2021-06-06 07:25:37.513527 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 07:25:37.515020 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 07:25:37.516066 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 07:25:37.518947 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 07:25:37.526566 (MainThread): Parsing macros/core.sql
2021-06-06 07:25:37.529504 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 07:25:37.535933 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 07:25:37.537224 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 07:25:37.549680 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 07:25:37.577186 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 07:25:37.592613 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 07:25:37.593899 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 07:25:37.598126 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 07:25:37.608679 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 07:25:37.613769 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 07:25:37.618397 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 07:25:37.621943 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 07:25:37.622647 (MainThread): Parsing macros/etc/query.sql
2021-06-06 07:25:37.623511 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 07:25:37.624734 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 07:25:37.631584 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 07:25:37.633103 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 07:25:37.634343 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 07:25:37.668031 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 07:25:37.669522 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 07:25:37.670641 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 07:25:37.671893 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 07:25:37.677410 (MainThread): Partial parsing not enabled
2021-06-06 07:25:37.694021 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 07:25:37.700611 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 07:25:37.702896 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 07:25:37.779999 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 07:25:37.780526 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31a01ec6-4733-4772-9896-b9664c132dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3cc91d30>]}
2021-06-06 07:25:37.784432 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31a01ec6-4733-4772-9896-b9664c132dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3cd730a0>]}
2021-06-06 07:25:37.784612 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-06 07:25:37.785103 (MainThread): 
2021-06-06 07:25:37.785273 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 07:25:37.785864 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-06 07:25:37.793884 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-06 07:25:37.793971 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-06 07:25:37.794018 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 07:25:39.065429 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.27 seconds
2021-06-06 07:25:39.073900 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-06 07:25:39.352448 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 07:25:39.364138 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 07:25:39.364297 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 07:25:39.364413 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 07:25:40.205845 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.84 seconds
2021-06-06 07:25:40.209510 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-06 07:25:40.505328 (MainThread): Using snowflake connection "master".
2021-06-06 07:25:40.505622 (MainThread): On master: BEGIN
2021-06-06 07:25:40.505758 (MainThread): Opening a new connection, currently in state init
2021-06-06 07:25:41.402982 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-06-06 07:25:41.403829 (MainThread): On master: COMMIT
2021-06-06 07:25:41.404389 (MainThread): Using snowflake connection "master".
2021-06-06 07:25:41.404636 (MainThread): On master: COMMIT
2021-06-06 07:25:41.648874 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-06-06 07:25:41.649695 (MainThread): On master: Close
2021-06-06 07:25:41.941790 (MainThread): 15:25:41 | Concurrency: 1 threads (target='dev')
2021-06-06 07:25:41.942372 (MainThread): 15:25:41 | 
2021-06-06 07:25:41.944618 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-06 07:25:41.945106 (Thread-1): 15:25:41 | 1 of 3 START view model public.stg_customers......................... [RUN]
2021-06-06 07:25:41.945725 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 07:25:41.945934 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-06 07:25:41.950560 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-06 07:25:41.951483 (Thread-1): finished collecting timing info
2021-06-06 07:25:41.974296 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-06-06 07:25:41.975482 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 07:25:41.975540 (Thread-1): On model.my_new_project.stg_customers: BEGIN
2021-06-06 07:25:41.975587 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 07:25:43.086305 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-06-06 07:25:43.087054 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 07:25:43.087242 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view test_dbt.public.stg_customers  as (
    with 

source as (

    select * from test_raw.public.customers

),

cleaned as (
    
    select

    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
            
    from source

)

select * from cleaned
  );
2021-06-06 07:25:43.476954 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-06-06 07:25:43.481028 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-06 07:25:43.481563 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 07:25:43.481747 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-06 07:25:43.642591 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-06-06 07:25:43.656434 (Thread-1): finished collecting timing info
2021-06-06 07:25:43.656673 (Thread-1): On model.my_new_project.stg_customers: Close
2021-06-06 07:25:43.944500 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a01ec6-4733-4772-9896-b9664c132dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3cedf970>]}
2021-06-06 07:25:43.945175 (Thread-1): 15:25:43 | 1 of 3 OK created view model public.stg_customers.................... [SUCCESS 1 in 2.00s]
2021-06-06 07:25:43.945539 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-06 07:25:43.945748 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-06 07:25:43.946704 (Thread-1): 15:25:43 | 2 of 3 START view model public.stg_orders............................ [RUN]
2021-06-06 07:25:43.947193 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 07:25:43.947341 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-06 07:25:43.951663 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-06 07:25:43.954127 (Thread-1): finished collecting timing info
2021-06-06 07:25:43.956674 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-06-06 07:25:43.958068 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 07:25:43.958200 (Thread-1): On model.my_new_project.stg_orders: BEGIN
2021-06-06 07:25:43.958298 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 07:25:44.838706 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-06-06 07:25:44.839472 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 07:25:44.839637 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view test_dbt.public.stg_orders  as (
    with 

source as (

    select * from test_raw.public.orders

),

cleaned as (
    
    select

    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
            
    from source

)

select * from cleaned
  );
2021-06-06 07:25:45.221347 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-06-06 07:25:45.225324 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-06 07:25:45.225758 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 07:25:45.225933 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-06 07:25:45.391923 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-06 07:25:45.395620 (Thread-1): finished collecting timing info
2021-06-06 07:25:45.396147 (Thread-1): On model.my_new_project.stg_orders: Close
2021-06-06 07:25:45.673453 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a01ec6-4733-4772-9896-b9664c132dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3ceea8e0>]}
2021-06-06 07:25:45.674098 (Thread-1): 15:25:45 | 2 of 3 OK created view model public.stg_orders....................... [SUCCESS 1 in 1.73s]
2021-06-06 07:25:45.674380 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-06 07:25:45.675971 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 07:25:45.676317 (Thread-1): 15:25:45 | 3 of 3 START view model public.customer_orders....................... [RUN]
2021-06-06 07:25:45.676900 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 07:25:45.677083 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 07:25:45.682140 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 07:25:45.683812 (Thread-1): finished collecting timing info
2021-06-06 07:25:45.686352 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-06 07:25:45.688513 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 07:25:45.688620 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-06 07:25:45.688722 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 07:25:46.568632 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-06-06 07:25:46.569474 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 07:25:46.569740 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with 

customers as (
    select * from test_dbt.public.stg_customers
),

orders as (
    select * from test_dbt.public.stg_orders
),

cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from orders
    group by 1
),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from orders
    inner join cte_customer_orders on orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-06 07:25:47.007271 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-06-06 07:25:47.011646 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 07:25:47.012103 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 07:25:47.012293 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 07:25:47.187523 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-06 07:25:47.191337 (Thread-1): finished collecting timing info
2021-06-06 07:25:47.191885 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-06 07:25:47.468691 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a01ec6-4733-4772-9896-b9664c132dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed280cabe0>]}
2021-06-06 07:25:47.469437 (Thread-1): 15:25:47 | 3 of 3 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.79s]
2021-06-06 07:25:47.469724 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 07:25:47.471148 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 07:25:47.471468 (MainThread): Using snowflake connection "master".
2021-06-06 07:25:47.471599 (MainThread): On master: BEGIN
2021-06-06 07:25:47.471723 (MainThread): Opening a new connection, currently in state closed
2021-06-06 07:25:48.342325 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-06-06 07:25:48.343136 (MainThread): On master: COMMIT
2021-06-06 07:25:48.343517 (MainThread): Using snowflake connection "master".
2021-06-06 07:25:48.343700 (MainThread): On master: COMMIT
2021-06-06 07:25:48.617489 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-06-06 07:25:48.618262 (MainThread): On master: Close
2021-06-06 07:25:48.890503 (MainThread): 15:25:48 | 
2021-06-06 07:25:48.890803 (MainThread): 15:25:48 | Finished running 3 view models in 11.11s.
2021-06-06 07:25:48.891096 (MainThread): Connection 'master' was properly closed.
2021-06-06 07:25:48.891208 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 07:25:48.899681 (MainThread): 
2021-06-06 07:25:48.899945 (MainThread): Completed successfully
2021-06-06 07:25:48.900214 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-06 07:25:48.900524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3cc7e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed280ad640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed280ad4c0>]}
2021-06-06 07:25:48.900807 (MainThread): Flushing usage events
2021-06-06 08:27:38.065596 (MainThread): Running with dbt=0.19.1
2021-06-06 08:27:38.706765 (MainThread): Loading KWallet
2021-06-06 08:27:38.707130 (MainThread): Loading SecretService
2021-06-06 08:27:38.707410 (MainThread): Loading Windows
2021-06-06 08:27:38.707760 (MainThread): Loading chainer
2021-06-06 08:27:38.707939 (MainThread): Loading macOS
2021-06-06 08:27:38.999272 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-06 08:27:39.000692 (MainThread): Tracking: tracking
2021-06-06 08:27:39.000949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdb33dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc011970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc0119d0>]}
2021-06-06 08:27:39.008467 (MainThread): Partial parsing not enabled
2021-06-06 08:27:39.009469 (MainThread): Parsing macros/catalog.sql
2021-06-06 08:27:39.011571 (MainThread): Parsing macros/adapters.sql
2021-06-06 08:27:39.035421 (MainThread): Parsing macros/materializations/merge.sql
2021-06-06 08:27:39.036983 (MainThread): Parsing macros/materializations/view.sql
2021-06-06 08:27:39.038026 (MainThread): Parsing macros/materializations/table.sql
2021-06-06 08:27:39.040947 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-06 08:27:39.048474 (MainThread): Parsing macros/core.sql
2021-06-06 08:27:39.051249 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-06 08:27:39.057567 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-06 08:27:39.058804 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-06 08:27:39.071251 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-06 08:27:39.100284 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-06 08:27:39.116037 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-06 08:27:39.117312 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-06 08:27:39.121537 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-06 08:27:39.132303 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-06 08:27:39.137554 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-06 08:27:39.142237 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-06 08:27:39.145717 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-06 08:27:39.146336 (MainThread): Parsing macros/etc/query.sql
2021-06-06 08:27:39.147112 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-06 08:27:39.148206 (MainThread): Parsing macros/etc/datetime.sql
2021-06-06 08:27:39.154584 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-06 08:27:39.155921 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-06 08:27:39.157037 (MainThread): Parsing macros/adapters/common.sql
2021-06-06 08:27:39.189639 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-06 08:27:39.190885 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-06 08:27:39.191871 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-06 08:27:39.192986 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-06 08:27:39.198150 (MainThread): Partial parsing not enabled
2021-06-06 08:27:39.213734 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 08:27:39.220074 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-06 08:27:39.222337 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 08:27:39.224570 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 08:27:39.304586 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-06 08:27:39.304842 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b921eb2-0cf9-4844-a868-aeaa689a36c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdcac37f0>]}
2021-06-06 08:27:39.308429 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b921eb2-0cf9-4844-a868-aeaa689a36c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdcac3a00>]}
2021-06-06 08:27:39.308611 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-06 08:27:39.309148 (MainThread): 
2021-06-06 08:27:39.309352 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 08:27:39.309961 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-06 08:27:39.317728 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-06 08:27:39.317787 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-06 08:27:39.317832 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-06 08:27:40.616053 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.30 seconds
2021-06-06 08:27:40.623844 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-06 08:27:40.911552 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-06 08:27:40.922813 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-06 08:27:40.922958 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-06 08:27:40.923083 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-06 08:27:42.020203 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.10 seconds
2021-06-06 08:27:42.023296 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-06 08:27:42.316587 (MainThread): Using snowflake connection "master".
2021-06-06 08:27:42.316817 (MainThread): On master: BEGIN
2021-06-06 08:27:42.316939 (MainThread): Opening a new connection, currently in state init
2021-06-06 08:27:43.213924 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-06-06 08:27:43.214696 (MainThread): On master: COMMIT
2021-06-06 08:27:43.215115 (MainThread): Using snowflake connection "master".
2021-06-06 08:27:43.215291 (MainThread): On master: COMMIT
2021-06-06 08:27:43.513987 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-06-06 08:27:43.514909 (MainThread): On master: Close
2021-06-06 08:27:43.823047 (MainThread): 16:27:43 | Concurrency: 1 threads (target='dev')
2021-06-06 08:27:43.823384 (MainThread): 16:27:43 | 
2021-06-06 08:27:43.825395 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-06 08:27:43.825849 (Thread-1): 16:27:43 | 1 of 4 START view model public.stg_customers......................... [RUN]
2021-06-06 08:27:43.826314 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-06 08:27:43.826474 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-06 08:27:43.831075 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-06 08:27:43.831969 (Thread-1): finished collecting timing info
2021-06-06 08:27:43.862818 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-06-06 08:27:43.863751 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 08:27:43.863803 (Thread-1): On model.my_new_project.stg_customers: BEGIN
2021-06-06 08:27:43.863848 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 08:27:44.739617 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-06-06 08:27:44.740465 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 08:27:44.740711 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view test_dbt.public.stg_customers  as (
    with 

source as (

    select * from test_raw.public.customers

),

cleaned as (
    
    select

    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
            
    from source

)

select * from cleaned
  );
2021-06-06 08:27:45.115607 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-06-06 08:27:45.118969 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-06 08:27:45.119297 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-06 08:27:45.119407 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-06 08:27:45.302798 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-06-06 08:27:45.319159 (Thread-1): finished collecting timing info
2021-06-06 08:27:45.319472 (Thread-1): On model.my_new_project.stg_customers: Close
2021-06-06 08:27:45.600716 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b921eb2-0cf9-4844-a868-aeaa689a36c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdcdc1940>]}
2021-06-06 08:27:45.601306 (Thread-1): 16:27:45 | 1 of 4 OK created view model public.stg_customers.................... [SUCCESS 1 in 1.77s]
2021-06-06 08:27:45.601519 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-06 08:27:45.601722 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-06 08:27:45.601983 (Thread-1): 16:27:45 | 2 of 4 START view model public.stg_orders............................ [RUN]
2021-06-06 08:27:45.603049 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-06 08:27:45.603224 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-06 08:27:45.607686 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-06 08:27:45.608448 (Thread-1): finished collecting timing info
2021-06-06 08:27:45.611198 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-06-06 08:27:45.612541 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 08:27:45.612647 (Thread-1): On model.my_new_project.stg_orders: BEGIN
2021-06-06 08:27:45.612743 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 08:27:46.515209 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-06-06 08:27:46.515909 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 08:27:46.516047 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view test_dbt.public.stg_orders  as (
    with 

source as (

    select * from test_raw.public.orders

),

cleaned as (
    
    select

    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
            
    from source

)

select * from cleaned
  );
2021-06-06 08:27:46.896036 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-06-06 08:27:46.898565 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-06 08:27:46.898938 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-06 08:27:46.899052 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-06 08:27:47.083436 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-06-06 08:27:47.086888 (Thread-1): finished collecting timing info
2021-06-06 08:27:47.087324 (Thread-1): On model.my_new_project.stg_orders: Close
2021-06-06 08:27:47.395524 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b921eb2-0cf9-4844-a868-aeaa689a36c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdcc0d490>]}
2021-06-06 08:27:47.396212 (Thread-1): 16:27:47 | 2 of 4 OK created view model public.stg_orders....................... [SUCCESS 1 in 1.79s]
2021-06-06 08:27:47.396428 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-06 08:27:47.396634 (Thread-1): Began running node model.my_new_project.stg_order_details
2021-06-06 08:27:47.397131 (Thread-1): 16:27:47 | 3 of 4 START view model public.stg_order_details..................... [RUN]
2021-06-06 08:27:47.397892 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-06 08:27:47.398105 (Thread-1): Compiling model.my_new_project.stg_order_details
2021-06-06 08:27:47.400978 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_order_details"
2021-06-06 08:27:47.401358 (Thread-1): finished collecting timing info
2021-06-06 08:27:47.402633 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_order_details"
2021-06-06 08:27:47.403444 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-06 08:27:47.403506 (Thread-1): On model.my_new_project.stg_order_details: BEGIN
2021-06-06 08:27:47.403561 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 08:27:48.385117 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-06-06 08:27:48.385866 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-06 08:27:48.386043 (Thread-1): On model.my_new_project.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_order_details"} */

  create or replace  view test_dbt.public.stg_order_details  as (
    with 

source as (

    select * from test_raw.public.order_details

),

cleaned as (
    
    select

    orderid AS order_id,
    productid AS product_id,
    unitprice,
    quantity,
    discount
     
    from source

)

select * from cleaned
  );
2021-06-06 08:27:48.744782 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-06-06 08:27:48.748172 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-06 08:27:48.748501 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-06 08:27:48.748619 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-06 08:27:48.922949 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-06 08:27:48.925837 (Thread-1): finished collecting timing info
2021-06-06 08:27:48.926267 (Thread-1): On model.my_new_project.stg_order_details: Close
2021-06-06 08:27:49.238003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b921eb2-0cf9-4844-a868-aeaa689a36c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdcd43d00>]}
2021-06-06 08:27:49.238831 (Thread-1): 16:27:49 | 3 of 4 OK created view model public.stg_order_details................ [SUCCESS 1 in 1.84s]
2021-06-06 08:27:49.239104 (Thread-1): Finished running node model.my_new_project.stg_order_details
2021-06-06 08:27:49.239333 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-06 08:27:49.239800 (Thread-1): 16:27:49 | 4 of 4 START view model public.customer_orders....................... [RUN]
2021-06-06 08:27:49.240258 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-06 08:27:49.240462 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-06 08:27:49.245301 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-06 08:27:49.245952 (Thread-1): finished collecting timing info
2021-06-06 08:27:49.248360 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-06 08:27:49.250322 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 08:27:49.250447 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-06 08:27:49.250540 (Thread-1): Opening a new connection, currently in state closed
2021-06-06 08:27:50.128496 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-06-06 08:27:50.129174 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 08:27:50.129361 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with 

customers as (
    select * from test_dbt.public.stg_customers
),

orders as (
    select * from test_dbt.public.stg_orders
),

cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from orders
    group by 1
),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from orders
    inner join cte_customer_orders on orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-06 08:27:50.555080 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-06-06 08:27:50.558016 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 08:27:50.558434 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-06 08:27:50.558570 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-06 08:27:50.710012 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-06-06 08:27:50.713056 (Thread-1): finished collecting timing info
2021-06-06 08:27:50.713492 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-06 08:27:51.001726 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b921eb2-0cf9-4844-a868-aeaa689a36c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdcd43790>]}
2021-06-06 08:27:51.002367 (Thread-1): 16:27:51 | 4 of 4 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.76s]
2021-06-06 08:27:51.002589 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-06 08:27:51.006285 (MainThread): Acquiring new snowflake connection "master".
2021-06-06 08:27:51.006626 (MainThread): Using snowflake connection "master".
2021-06-06 08:27:51.006748 (MainThread): On master: BEGIN
2021-06-06 08:27:51.006860 (MainThread): Opening a new connection, currently in state closed
2021-06-06 08:27:51.923646 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-06-06 08:27:51.924649 (MainThread): On master: COMMIT
2021-06-06 08:27:51.925187 (MainThread): Using snowflake connection "master".
2021-06-06 08:27:51.925445 (MainThread): On master: COMMIT
2021-06-06 08:27:52.192765 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-06-06 08:27:52.193597 (MainThread): On master: Close
2021-06-06 08:27:52.497814 (MainThread): 16:27:52 | 
2021-06-06 08:27:52.498156 (MainThread): 16:27:52 | Finished running 4 view models in 13.19s.
2021-06-06 08:27:52.498320 (MainThread): Connection 'master' was properly closed.
2021-06-06 08:27:52.498427 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-06 08:27:52.505751 (MainThread): 
2021-06-06 08:27:52.505999 (MainThread): Completed successfully
2021-06-06 08:27:52.506183 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-06 08:27:52.506439 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdce67640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdce67a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc83039a0>]}
2021-06-06 08:27:52.506754 (MainThread): Flushing usage events
2021-06-08 13:34:00.235975 (MainThread): Running with dbt=0.19.1
2021-06-08 13:34:01.000132 (MainThread): Loading KWallet
2021-06-08 13:34:01.000680 (MainThread): Loading SecretService
2021-06-08 13:34:01.001144 (MainThread): Loading Windows
2021-06-08 13:34:01.001530 (MainThread): Loading chainer
2021-06-08 13:34:01.001858 (MainThread): Loading macOS
2021-06-08 13:34:01.344809 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-08 13:34:01.345940 (MainThread): Tracking: tracking
2021-06-08 13:34:01.346244 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce29f45e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2a8029a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2a802a00>]}
2021-06-08 13:34:01.354405 (MainThread): Partial parsing not enabled
2021-06-08 13:34:01.355284 (MainThread): Parsing macros/catalog.sql
2021-06-08 13:34:01.357679 (MainThread): Parsing macros/adapters.sql
2021-06-08 13:34:01.382865 (MainThread): Parsing macros/materializations/merge.sql
2021-06-08 13:34:01.384546 (MainThread): Parsing macros/materializations/view.sql
2021-06-08 13:34:01.385656 (MainThread): Parsing macros/materializations/table.sql
2021-06-08 13:34:01.388865 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-08 13:34:01.397087 (MainThread): Parsing macros/core.sql
2021-06-08 13:34:01.400338 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-08 13:34:01.407506 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-08 13:34:01.409078 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-08 13:34:01.422200 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-08 13:34:01.449941 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-08 13:34:01.465877 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-08 13:34:01.467237 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-08 13:34:01.471631 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-08 13:34:01.482494 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-08 13:34:01.487686 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-08 13:34:01.492455 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-08 13:34:01.496177 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-08 13:34:01.496894 (MainThread): Parsing macros/etc/query.sql
2021-06-08 13:34:01.497738 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-08 13:34:01.498897 (MainThread): Parsing macros/etc/datetime.sql
2021-06-08 13:34:01.505411 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-08 13:34:01.506827 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-08 13:34:01.508016 (MainThread): Parsing macros/adapters/common.sql
2021-06-08 13:34:01.542844 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-08 13:34:01.545096 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-08 13:34:01.547527 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-08 13:34:01.549072 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-08 13:34:01.554846 (MainThread): Partial parsing not enabled
2021-06-08 13:34:01.572831 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-08 13:34:01.580190 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-08 13:34:01.582819 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-08 13:34:01.585449 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-08 13:34:01.590281 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce19b4e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf82258b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf8225a30>]}
2021-06-08 13:34:01.590455 (MainThread): Flushing usage events
2021-06-08 13:34:03.124814 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-08 13:34:03.125028 (MainThread): Encountered an error:
2021-06-08 13:34:03.125135 (MainThread): Compilation Error
  The schema file at staging/customer_data/stg_cutomers.yml is invalid because no version is specified. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files
2021-06-08 13:34:03.128138 (MainThread): Traceback (most recent call last):
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 643, in parse_file
    self._check_format_version(yaml_block)
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/parser/schemas.py", line 226, in _check_format_version
    raise_invalid_schema_yml_version(path, 'no version is specified')
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 895, in raise_invalid_schema_yml_version
    raise_compiler_error(
  File "/Users/ashsmith/opt/anaconda3/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at staging/customer_data/stg_cutomers.yml is invalid because no version is specified. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files

2021-06-08 13:34:21.604192 (MainThread): Running with dbt=0.19.1
2021-06-08 13:34:22.050951 (MainThread): Loading KWallet
2021-06-08 13:34:22.051322 (MainThread): Loading SecretService
2021-06-08 13:34:22.051602 (MainThread): Loading Windows
2021-06-08 13:34:22.051947 (MainThread): Loading chainer
2021-06-08 13:34:22.052122 (MainThread): Loading macOS
2021-06-08 13:34:22.308124 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-08 13:34:22.309169 (MainThread): Tracking: tracking
2021-06-08 13:34:22.309423 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac51eadd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5294cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5294cf70>]}
2021-06-08 13:34:22.316785 (MainThread): Partial parsing not enabled
2021-06-08 13:34:22.317600 (MainThread): Parsing macros/catalog.sql
2021-06-08 13:34:22.319532 (MainThread): Parsing macros/adapters.sql
2021-06-08 13:34:22.342580 (MainThread): Parsing macros/materializations/merge.sql
2021-06-08 13:34:22.344177 (MainThread): Parsing macros/materializations/view.sql
2021-06-08 13:34:22.345209 (MainThread): Parsing macros/materializations/table.sql
2021-06-08 13:34:22.348044 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-08 13:34:22.355202 (MainThread): Parsing macros/core.sql
2021-06-08 13:34:22.358023 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-08 13:34:22.364303 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-08 13:34:22.365562 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-08 13:34:22.378062 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-08 13:34:22.405237 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-08 13:34:22.420707 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-08 13:34:22.421997 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-08 13:34:22.426291 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-08 13:34:22.436858 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-08 13:34:22.441987 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-08 13:34:22.446633 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-08 13:34:22.450204 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-08 13:34:22.450877 (MainThread): Parsing macros/etc/query.sql
2021-06-08 13:34:22.451709 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-08 13:34:22.452875 (MainThread): Parsing macros/etc/datetime.sql
2021-06-08 13:34:22.459241 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-08 13:34:22.460620 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-08 13:34:22.461757 (MainThread): Parsing macros/adapters/common.sql
2021-06-08 13:34:22.493906 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-08 13:34:22.495191 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-08 13:34:22.496228 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-08 13:34:22.497360 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-08 13:34:22.502591 (MainThread): Partial parsing not enabled
2021-06-08 13:34:22.518209 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-08 13:34:22.524866 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-08 13:34:22.527186 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-08 13:34:22.529485 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-08 13:34:22.621381 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-08 13:34:22.621688 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8c5b107-5b00-424f-8f3e-dbfff2b2b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac61a7e5e0>]}
2021-06-08 13:34:22.625672 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8c5b107-5b00-424f-8f3e-dbfff2b2b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac61a2fe20>]}
2021-06-08 13:34:22.625881 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-08 13:34:22.626519 (MainThread): 
2021-06-08 13:34:22.626725 (MainThread): Acquiring new snowflake connection "master".
2021-06-08 13:34:22.627370 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-08 13:34:22.635486 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-08 13:34:22.635548 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-08 13:34:22.635593 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-08 13:34:24.036146 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.40 seconds
2021-06-08 13:34:24.042142 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-08 13:34:24.262093 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-08 13:34:24.267737 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-08 13:34:24.267824 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-08 13:34:24.267891 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-08 13:34:25.251232 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.98 seconds
2021-06-08 13:34:25.254187 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-08 13:34:25.459725 (MainThread): Using snowflake connection "master".
2021-06-08 13:34:25.459877 (MainThread): On master: BEGIN
2021-06-08 13:34:25.459938 (MainThread): Opening a new connection, currently in state init
2021-06-08 13:34:26.190327 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2021-06-08 13:34:26.190868 (MainThread): On master: COMMIT
2021-06-08 13:34:26.191420 (MainThread): Using snowflake connection "master".
2021-06-08 13:34:26.192076 (MainThread): On master: COMMIT
2021-06-08 13:34:26.427471 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-06-08 13:34:26.427980 (MainThread): On master: Close
2021-06-08 13:34:26.663284 (MainThread): 21:34:26 | Concurrency: 1 threads (target='dev')
2021-06-08 13:34:26.663817 (MainThread): 21:34:26 | 
2021-06-08 13:34:26.665010 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-08 13:34:26.665301 (Thread-1): 21:34:26 | 1 of 4 START view model public.stg_customers......................... [RUN]
2021-06-08 13:34:26.665545 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-08 13:34:26.665632 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-08 13:34:26.668080 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-08 13:34:26.669140 (Thread-1): finished collecting timing info
2021-06-08 13:34:26.689747 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-06-08 13:34:26.690766 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-08 13:34:26.690835 (Thread-1): On model.my_new_project.stg_customers: BEGIN
2021-06-08 13:34:26.690891 (Thread-1): Opening a new connection, currently in state closed
2021-06-08 13:34:27.366041 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-06-08 13:34:27.366710 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-08 13:34:27.366831 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view test_dbt.public.stg_customers  as (
    with 

source as (

    select * from test_raw.public.customers

),

cleaned as (
    
    select

    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
            
    from source

)

select * from cleaned
  );
2021-06-08 13:34:27.759895 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-06-08 13:34:27.761876 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-08 13:34:27.762147 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-08 13:34:27.762262 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-08 13:34:27.901090 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-06-08 13:34:27.911130 (Thread-1): finished collecting timing info
2021-06-08 13:34:27.911350 (Thread-1): On model.my_new_project.stg_customers: Close
2021-06-08 13:34:28.136308 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c5b107-5b00-424f-8f3e-dbfff2b2b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac61d2c940>]}
2021-06-08 13:34:28.136620 (Thread-1): 21:34:28 | 1 of 4 OK created view model public.stg_customers.................... [SUCCESS 1 in 1.47s]
2021-06-08 13:34:28.136728 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-08 13:34:28.136836 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-08 13:34:28.136963 (Thread-1): 21:34:28 | 2 of 4 START view model public.stg_orders............................ [RUN]
2021-06-08 13:34:28.137572 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-08 13:34:28.137672 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-08 13:34:28.139942 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-08 13:34:28.140289 (Thread-1): finished collecting timing info
2021-06-08 13:34:28.141890 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-06-08 13:34:28.142841 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-08 13:34:28.142905 (Thread-1): On model.my_new_project.stg_orders: BEGIN
2021-06-08 13:34:28.142959 (Thread-1): Opening a new connection, currently in state closed
2021-06-08 13:34:28.836714 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-06-08 13:34:28.837237 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-08 13:34:28.837587 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view test_dbt.public.stg_orders  as (
    with 

source as (

    select * from test_raw.public.orders

),

cleaned as (
    
    select

    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
            
    from source

)

select * from cleaned
  );
2021-06-08 13:34:29.196363 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-06-08 13:34:29.199168 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-08 13:34:29.199635 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-08 13:34:29.199758 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-08 13:34:29.326358 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-06-08 13:34:29.328446 (Thread-1): finished collecting timing info
2021-06-08 13:34:29.328868 (Thread-1): On model.my_new_project.stg_orders: Close
2021-06-08 13:34:29.565267 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c5b107-5b00-424f-8f3e-dbfff2b2b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac61e28250>]}
2021-06-08 13:34:29.566678 (Thread-1): 21:34:29 | 2 of 4 OK created view model public.stg_orders....................... [SUCCESS 1 in 1.43s]
2021-06-08 13:34:29.566966 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-08 13:34:29.567244 (Thread-1): Began running node model.my_new_project.stg_order_details
2021-06-08 13:34:29.567900 (Thread-1): 21:34:29 | 3 of 4 START view model public.stg_order_details..................... [RUN]
2021-06-08 13:34:29.568410 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-08 13:34:29.568528 (Thread-1): Compiling model.my_new_project.stg_order_details
2021-06-08 13:34:29.571065 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_order_details"
2021-06-08 13:34:29.572394 (Thread-1): finished collecting timing info
2021-06-08 13:34:29.573831 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_order_details"
2021-06-08 13:34:29.574664 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-08 13:34:29.574726 (Thread-1): On model.my_new_project.stg_order_details: BEGIN
2021-06-08 13:34:29.574780 (Thread-1): Opening a new connection, currently in state closed
2021-06-08 13:34:30.228029 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-06-08 13:34:30.228523 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-08 13:34:30.228651 (Thread-1): On model.my_new_project.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_order_details"} */

  create or replace  view test_dbt.public.stg_order_details  as (
    with 

source as (

    select * from test_raw.public.order_details

),

cleaned as (
    
    select

    orderid AS order_id,
    productid AS product_id,
    unitprice,
    quantity,
    discount
     
    from source

)

select * from cleaned
  );
2021-06-08 13:34:30.730955 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-06-08 13:34:30.734206 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-08 13:34:30.734523 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-08 13:34:30.734671 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-08 13:34:30.869332 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-06-08 13:34:30.871538 (Thread-1): finished collecting timing info
2021-06-08 13:34:30.872063 (Thread-1): On model.my_new_project.stg_order_details: Close
2021-06-08 13:34:31.089271 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c5b107-5b00-424f-8f3e-dbfff2b2b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac400fcbb0>]}
2021-06-08 13:34:31.090162 (Thread-1): 21:34:31 | 3 of 4 OK created view model public.stg_order_details................ [SUCCESS 1 in 1.52s]
2021-06-08 13:34:31.090348 (Thread-1): Finished running node model.my_new_project.stg_order_details
2021-06-08 13:34:31.090456 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-08 13:34:31.090678 (Thread-1): 21:34:31 | 4 of 4 START view model public.customer_orders....................... [RUN]
2021-06-08 13:34:31.090943 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-08 13:34:31.091043 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-08 13:34:31.093602 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-08 13:34:31.094060 (Thread-1): finished collecting timing info
2021-06-08 13:34:31.095518 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-08 13:34:31.096750 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-08 13:34:31.096816 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-08 13:34:31.096869 (Thread-1): Opening a new connection, currently in state closed
2021-06-08 13:34:31.842245 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-06-08 13:34:31.842636 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-08 13:34:31.842757 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with 

customers as (
    select * from test_dbt.public.stg_customers
),

orders as (
    select * from test_dbt.public.stg_orders
),

cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from orders
    group by 1
),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from orders
    inner join cte_customer_orders on orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-08 13:34:32.368804 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-06-08 13:34:32.371636 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-08 13:34:32.372119 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-08 13:34:32.372277 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-08 13:34:32.500281 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-06-08 13:34:32.502985 (Thread-1): finished collecting timing info
2021-06-08 13:34:32.503404 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-08 13:34:32.722153 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c5b107-5b00-424f-8f3e-dbfff2b2b59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac400fcd00>]}
2021-06-08 13:34:32.722539 (Thread-1): 21:34:32 | 4 of 4 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.63s]
2021-06-08 13:34:32.722647 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-08 13:34:32.724778 (MainThread): Acquiring new snowflake connection "master".
2021-06-08 13:34:32.725022 (MainThread): Using snowflake connection "master".
2021-06-08 13:34:32.725083 (MainThread): On master: BEGIN
2021-06-08 13:34:32.725139 (MainThread): Opening a new connection, currently in state closed
2021-06-08 13:34:33.406986 (MainThread): SQL status: SUCCESS 1 in 0.68 seconds
2021-06-08 13:34:33.407520 (MainThread): On master: COMMIT
2021-06-08 13:34:33.408291 (MainThread): Using snowflake connection "master".
2021-06-08 13:34:33.408838 (MainThread): On master: COMMIT
2021-06-08 13:34:33.650380 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-06-08 13:34:33.651116 (MainThread): On master: Close
2021-06-08 13:34:33.866993 (MainThread): 21:34:33 | 
2021-06-08 13:34:33.867726 (MainThread): 21:34:33 | Finished running 4 view models in 11.24s.
2021-06-08 13:34:33.867983 (MainThread): Connection 'master' was properly closed.
2021-06-08 13:34:33.868169 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-08 13:34:33.868222 (MainThread): Connection 'list_test_dbt_public' was properly closed.
2021-06-08 13:34:33.872193 (MainThread): 
2021-06-08 13:34:33.872344 (MainThread): Completed successfully
2021-06-08 13:34:33.872424 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-08 13:34:33.872553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac61a2f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac400fcd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac400fcd60>]}
2021-06-08 13:34:33.872711 (MainThread): Flushing usage events
2021-06-08 13:34:45.697185 (MainThread): Running with dbt=0.19.1
2021-06-08 13:34:46.147039 (MainThread): Loading KWallet
2021-06-08 13:34:46.147427 (MainThread): Loading SecretService
2021-06-08 13:34:46.147699 (MainThread): Loading Windows
2021-06-08 13:34:46.148053 (MainThread): Loading chainer
2021-06-08 13:34:46.148228 (MainThread): Loading macOS
2021-06-08 13:34:46.405787 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-08 13:34:46.407171 (MainThread): Tracking: tracking
2021-06-08 13:34:46.407462 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c41d8dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c425019a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c42501a00>]}
2021-06-08 13:34:46.416089 (MainThread): Partial parsing not enabled
2021-06-08 13:34:46.417718 (MainThread): Parsing macros/catalog.sql
2021-06-08 13:34:46.420111 (MainThread): Parsing macros/adapters.sql
2021-06-08 13:34:46.446134 (MainThread): Parsing macros/materializations/merge.sql
2021-06-08 13:34:46.447984 (MainThread): Parsing macros/materializations/view.sql
2021-06-08 13:34:46.449144 (MainThread): Parsing macros/materializations/table.sql
2021-06-08 13:34:46.452382 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-08 13:34:46.460108 (MainThread): Parsing macros/core.sql
2021-06-08 13:34:46.462999 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-08 13:34:46.469609 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-08 13:34:46.470918 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-08 13:34:46.484618 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-08 13:34:46.517362 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-08 13:34:46.534714 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-08 13:34:46.536170 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-08 13:34:46.540644 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-08 13:34:46.551712 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-08 13:34:46.557582 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-08 13:34:46.562500 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-08 13:34:46.566226 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-08 13:34:46.566896 (MainThread): Parsing macros/etc/query.sql
2021-06-08 13:34:46.567767 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-08 13:34:46.568931 (MainThread): Parsing macros/etc/datetime.sql
2021-06-08 13:34:46.575548 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-08 13:34:46.576918 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-08 13:34:46.578092 (MainThread): Parsing macros/adapters/common.sql
2021-06-08 13:34:46.611887 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-08 13:34:46.613217 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-08 13:34:46.614195 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-08 13:34:46.615354 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-08 13:34:46.620699 (MainThread): Partial parsing not enabled
2021-06-08 13:34:46.637030 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-08 13:34:46.643636 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-08 13:34:46.646015 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-08 13:34:46.648405 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-08 13:34:46.743029 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-08 13:34:46.743360 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '944aaacc-5d08-4f69-b0eb-c7a4f12010d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62177910>]}
2021-06-08 13:34:46.746991 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '944aaacc-5d08-4f69-b0eb-c7a4f12010d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c42b84a90>]}
2021-06-08 13:34:46.747191 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-08 13:34:46.747780 (MainThread): 
2021-06-08 13:34:46.747971 (MainThread): Acquiring new snowflake connection "master".
2021-06-08 13:34:46.748785 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-08 13:34:46.756619 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-08 13:34:46.756683 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-08 13:34:46.756729 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-08 13:34:47.727854 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.97 seconds
2021-06-08 13:34:47.733900 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-08 13:34:47.954203 (MainThread): 21:34:47 | Concurrency: 1 threads (target='dev')
2021-06-08 13:34:47.954701 (MainThread): 21:34:47 | 
2021-06-08 13:34:47.956136 (Thread-1): Began running node test.my_new_project.not_null_stg_customers_customer_id
2021-06-08 13:34:47.956313 (Thread-1): 21:34:47 | 1 of 2 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-08 13:34:47.956624 (Thread-1): Acquiring new snowflake connection "test.my_new_project.not_null_stg_customers_customer_id".
2021-06-08 13:34:47.956725 (Thread-1): Compiling test.my_new_project.not_null_stg_customers_customer_id
2021-06-08 13:34:47.963053 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_stg_customers_customer_id"
2021-06-08 13:34:47.963517 (Thread-1): finished collecting timing info
2021-06-08 13:34:47.963916 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_customer_id".
2021-06-08 13:34:47.963976 (Thread-1): On test.my_new_project.not_null_stg_customers_customer_id: BEGIN
2021-06-08 13:34:47.964030 (Thread-1): Opening a new connection, currently in state closed
2021-06-08 13:34:49.131526 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-06-08 13:34:49.132224 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_customer_id".
2021-06-08 13:34:49.132378 (Thread-1): On test.my_new_project.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from test_dbt.public.stg_customers
where customer_id is null
2021-06-08 13:34:49.973019 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-06-08 13:34:49.974672 (Thread-1): finished collecting timing info
2021-06-08 13:34:49.974793 (Thread-1): On test.my_new_project.not_null_stg_customers_customer_id: ROLLBACK
2021-06-08 13:34:50.225473 (Thread-1): On test.my_new_project.not_null_stg_customers_customer_id: Close
2021-06-08 13:34:50.442030 (Thread-1): 21:34:50 | 1 of 2 PASS not_null_stg_customers_customer_id....................... [PASS in 2.49s]
2021-06-08 13:34:50.442425 (Thread-1): Finished running node test.my_new_project.not_null_stg_customers_customer_id
2021-06-08 13:34:50.442669 (Thread-1): Began running node test.my_new_project.unique_stg_customers_customer_id
2021-06-08 13:34:50.442868 (Thread-1): 21:34:50 | 2 of 2 START test unique_stg_customers_customer_id................... [RUN]
2021-06-08 13:34:50.443739 (Thread-1): Acquiring new snowflake connection "test.my_new_project.unique_stg_customers_customer_id".
2021-06-08 13:34:50.443851 (Thread-1): Compiling test.my_new_project.unique_stg_customers_customer_id
2021-06-08 13:34:50.450084 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_stg_customers_customer_id"
2021-06-08 13:34:50.450505 (Thread-1): finished collecting timing info
2021-06-08 13:34:50.451054 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_customer_id".
2021-06-08 13:34:50.451123 (Thread-1): On test.my_new_project.unique_stg_customers_customer_id: BEGIN
2021-06-08 13:34:50.451187 (Thread-1): Opening a new connection, currently in state closed
2021-06-08 13:34:51.150417 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2021-06-08 13:34:51.151069 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_customer_id".
2021-06-08 13:34:51.151227 (Thread-1): On test.my_new_project.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from test_dbt.public.stg_customers
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors
2021-06-08 13:34:51.525837 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-06-08 13:34:51.526821 (Thread-1): finished collecting timing info
2021-06-08 13:34:51.527222 (Thread-1): On test.my_new_project.unique_stg_customers_customer_id: ROLLBACK
2021-06-08 13:34:51.749688 (Thread-1): On test.my_new_project.unique_stg_customers_customer_id: Close
2021-06-08 13:34:51.977115 (Thread-1): 21:34:51 | 2 of 2 PASS unique_stg_customers_customer_id......................... [PASS in 1.53s]
2021-06-08 13:34:51.977575 (Thread-1): Finished running node test.my_new_project.unique_stg_customers_customer_id
2021-06-08 13:34:51.979823 (MainThread): Acquiring new snowflake connection "master".
2021-06-08 13:34:51.980144 (MainThread): 21:34:51 | 
2021-06-08 13:34:51.980243 (MainThread): 21:34:51 | Finished running 2 tests in 5.23s.
2021-06-08 13:34:51.980313 (MainThread): Connection 'master' was properly closed.
2021-06-08 13:34:51.980361 (MainThread): Connection 'test.my_new_project.unique_stg_customers_customer_id' was properly closed.
2021-06-08 13:34:51.984425 (MainThread): 
2021-06-08 13:34:51.984584 (MainThread): Completed successfully
2021-06-08 13:34:51.984660 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-08 13:34:51.984787 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62172280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c3016f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c3016f580>]}
2021-06-08 13:34:51.984928 (MainThread): Flushing usage events
2021-06-08 13:37:18.186624 (MainThread): Running with dbt=0.19.1
2021-06-08 13:37:18.777941 (MainThread): Loading KWallet
2021-06-08 13:37:18.778323 (MainThread): Loading SecretService
2021-06-08 13:37:18.778606 (MainThread): Loading Windows
2021-06-08 13:37:18.778953 (MainThread): Loading chainer
2021-06-08 13:37:18.779133 (MainThread): Loading macOS
2021-06-08 13:37:19.054360 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-08 13:37:19.055611 (MainThread): Tracking: tracking
2021-06-08 13:37:19.055916 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62a1adc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62aa7bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62aa7bd00>]}
2021-06-08 13:37:19.063823 (MainThread): Partial parsing not enabled
2021-06-08 13:37:19.064618 (MainThread): Parsing macros/catalog.sql
2021-06-08 13:37:19.066678 (MainThread): Parsing macros/adapters.sql
2021-06-08 13:37:19.091450 (MainThread): Parsing macros/materializations/merge.sql
2021-06-08 13:37:19.093072 (MainThread): Parsing macros/materializations/view.sql
2021-06-08 13:37:19.094141 (MainThread): Parsing macros/materializations/table.sql
2021-06-08 13:37:19.097166 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-08 13:37:19.104910 (MainThread): Parsing macros/core.sql
2021-06-08 13:37:19.107935 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-08 13:37:19.114531 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-08 13:37:19.115887 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-08 13:37:19.128710 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-08 13:37:19.158813 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-08 13:37:19.175109 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-08 13:37:19.176400 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-08 13:37:19.180778 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-08 13:37:19.192038 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-08 13:37:19.197500 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-08 13:37:19.202367 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-08 13:37:19.205968 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-08 13:37:19.206680 (MainThread): Parsing macros/etc/query.sql
2021-06-08 13:37:19.207525 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-08 13:37:19.208665 (MainThread): Parsing macros/etc/datetime.sql
2021-06-08 13:37:19.215295 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-08 13:37:19.216645 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-08 13:37:19.217821 (MainThread): Parsing macros/adapters/common.sql
2021-06-08 13:37:19.252024 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-08 13:37:19.253319 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-08 13:37:19.254385 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-08 13:37:19.255648 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-08 13:37:19.261101 (MainThread): Partial parsing not enabled
2021-06-08 13:37:19.277504 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-08 13:37:19.284268 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-08 13:37:19.286674 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-08 13:37:19.288998 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-08 13:37:19.381366 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-08 13:37:19.381668 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2d4a5d8-a786-46d0-8bf6-f68f1de7ca8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa619ace490>]}
2021-06-08 13:37:19.385566 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2d4a5d8-a786-46d0-8bf6-f68f1de7ca8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6199d7dc0>]}
2021-06-08 13:37:19.385773 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-08 13:37:19.386488 (MainThread): 
2021-06-08 13:37:19.386681 (MainThread): Acquiring new snowflake connection "master".
2021-06-08 13:37:19.387443 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-08 13:37:19.395181 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-08 13:37:19.395247 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-08 13:37:19.395291 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-08 13:37:20.364218 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.97 seconds
2021-06-08 13:37:20.370272 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-08 13:37:20.652372 (MainThread): 21:37:20 | Concurrency: 1 threads (target='dev')
2021-06-08 13:37:20.652558 (MainThread): 21:37:20 | 
2021-06-08 13:37:20.653824 (Thread-1): Began running node test.my_new_project.not_null_stg_customers_customer_id
2021-06-08 13:37:20.653986 (Thread-1): 21:37:20 | 1 of 2 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-08 13:37:20.654214 (Thread-1): Acquiring new snowflake connection "test.my_new_project.not_null_stg_customers_customer_id".
2021-06-08 13:37:20.654301 (Thread-1): Compiling test.my_new_project.not_null_stg_customers_customer_id
2021-06-08 13:37:20.660736 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_stg_customers_customer_id"
2021-06-08 13:37:20.661553 (Thread-1): finished collecting timing info
2021-06-08 13:37:20.661958 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_customer_id".
2021-06-08 13:37:20.662023 (Thread-1): On test.my_new_project.not_null_stg_customers_customer_id: BEGIN
2021-06-08 13:37:20.662079 (Thread-1): Opening a new connection, currently in state closed
2021-06-08 13:37:21.543064 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-06-08 13:37:21.543513 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_customer_id".
2021-06-08 13:37:21.543640 (Thread-1): On test.my_new_project.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from test_dbt.public.stg_customers
where customer_id is null
2021-06-08 13:37:21.796449 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-06-08 13:37:21.797490 (Thread-1): finished collecting timing info
2021-06-08 13:37:21.797620 (Thread-1): On test.my_new_project.not_null_stg_customers_customer_id: ROLLBACK
2021-06-08 13:37:22.005823 (Thread-1): On test.my_new_project.not_null_stg_customers_customer_id: Close
2021-06-08 13:37:22.225353 (Thread-1): 21:37:22 | 1 of 2 PASS not_null_stg_customers_customer_id....................... [PASS in 1.57s]
2021-06-08 13:37:22.225795 (Thread-1): Finished running node test.my_new_project.not_null_stg_customers_customer_id
2021-06-08 13:37:22.226067 (Thread-1): Began running node test.my_new_project.unique_stg_customers_customer_id
2021-06-08 13:37:22.226664 (Thread-1): 21:37:22 | 2 of 2 START test unique_stg_customers_customer_id................... [RUN]
2021-06-08 13:37:22.226929 (Thread-1): Acquiring new snowflake connection "test.my_new_project.unique_stg_customers_customer_id".
2021-06-08 13:37:22.227013 (Thread-1): Compiling test.my_new_project.unique_stg_customers_customer_id
2021-06-08 13:37:22.233347 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_stg_customers_customer_id"
2021-06-08 13:37:22.234075 (Thread-1): finished collecting timing info
2021-06-08 13:37:22.234645 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_customer_id".
2021-06-08 13:37:22.234711 (Thread-1): On test.my_new_project.unique_stg_customers_customer_id: BEGIN
2021-06-08 13:37:22.234770 (Thread-1): Opening a new connection, currently in state closed
2021-06-08 13:37:22.889250 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-06-08 13:37:22.889639 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_customer_id".
2021-06-08 13:37:22.889807 (Thread-1): On test.my_new_project.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from test_dbt.public.stg_customers
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors
2021-06-08 13:37:23.380113 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-06-08 13:37:23.381474 (Thread-1): finished collecting timing info
2021-06-08 13:37:23.381830 (Thread-1): On test.my_new_project.unique_stg_customers_customer_id: ROLLBACK
2021-06-08 13:37:23.593328 (Thread-1): On test.my_new_project.unique_stg_customers_customer_id: Close
2021-06-08 13:37:23.810760 (Thread-1): 21:37:23 | 2 of 2 FAIL 21 unique_stg_customers_customer_id...................... [FAIL 21 in 1.58s]
2021-06-08 13:37:23.811357 (Thread-1): Finished running node test.my_new_project.unique_stg_customers_customer_id
2021-06-08 13:37:23.812958 (MainThread): Acquiring new snowflake connection "master".
2021-06-08 13:37:23.813236 (MainThread): 21:37:23 | 
2021-06-08 13:37:23.813323 (MainThread): 21:37:23 | Finished running 2 tests in 4.43s.
2021-06-08 13:37:23.813386 (MainThread): Connection 'master' was properly closed.
2021-06-08 13:37:23.813431 (MainThread): Connection 'test.my_new_project.unique_stg_customers_customer_id' was properly closed.
2021-06-08 13:37:23.817156 (MainThread): 
2021-06-08 13:37:23.817279 (MainThread): Completed with 1 error and 0 warnings:
2021-06-08 13:37:23.817351 (MainThread): 
2021-06-08 13:37:23.817419 (MainThread): Failure in test unique_stg_customers_customer_id (models/staging/customer_data/stg_cutomers.yml)
2021-06-08 13:37:23.817487 (MainThread):   Got 21 results, expected 0.
2021-06-08 13:37:23.817541 (MainThread): 
2021-06-08 13:37:23.817595 (MainThread):   compiled SQL at target/compiled/my_new_project/models/staging/customer_data/stg_cutomers.yml/schema_test/unique_stg_customers_customer_id.sql
2021-06-08 13:37:23.817656 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-06-08 13:37:23.817780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6183bedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa619ace6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa619b8a7c0>]}
2021-06-08 13:37:23.817942 (MainThread): Flushing usage events
2021-06-26 08:39:05.383111 (MainThread): Running with dbt=0.20.0-rc1
2021-06-26 08:39:06.041537 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-26 08:39:06.042360 (MainThread): Tracking: tracking
2021-06-26 08:39:06.042673 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11147fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11147feb0>]}
2021-06-26 08:39:06.052904 (MainThread): Partial parsing not enabled
2021-06-26 08:39:06.067048 (MainThread): Parsing macros/catalog.sql
2021-06-26 08:39:06.069046 (MainThread): Parsing macros/adapters.sql
2021-06-26 08:39:06.091960 (MainThread): Parsing macros/materializations/merge.sql
2021-06-26 08:39:06.093389 (MainThread): Parsing macros/materializations/view.sql
2021-06-26 08:39:06.094358 (MainThread): Parsing macros/materializations/table.sql
2021-06-26 08:39:06.097163 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-26 08:39:06.103803 (MainThread): Parsing macros/core.sql
2021-06-26 08:39:06.106515 (MainThread): Parsing macros/materializations/test.sql
2021-06-26 08:39:06.110441 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-26 08:39:06.117754 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-26 08:39:06.118920 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-26 08:39:06.131998 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-26 08:39:06.160059 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-26 08:39:06.176599 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-26 08:39:06.177831 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-26 08:39:06.183594 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-26 08:39:06.194670 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-26 08:39:06.200156 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-26 08:39:06.204922 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-26 08:39:06.208446 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-26 08:39:06.209016 (MainThread): Parsing macros/etc/query.sql
2021-06-26 08:39:06.209643 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-26 08:39:06.210710 (MainThread): Parsing macros/etc/datetime.sql
2021-06-26 08:39:06.217304 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-26 08:39:06.218591 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-26 08:39:06.219648 (MainThread): Parsing macros/adapters/common.sql
2021-06-26 08:39:06.256225 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-26 08:39:06.257407 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-26 08:39:06.258155 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-26 08:39:06.259034 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-26 08:39:06.377830 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:39:06.384445 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:39:06.386726 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:39:06.388776 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:39:06.407740 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:39:06.408981 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:39:06.424396 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-26 08:39:06.428333 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34b874ab-04cc-44bf-90a1-5b77ba1dd7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d5ca0>]}
2021-06-26 08:39:06.432909 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34b874ab-04cc-44bf-90a1-5b77ba1dd7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111582250>]}
2021-06-26 08:39:06.433066 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 149 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-26 08:39:06.433865 (MainThread): 
2021-06-26 08:39:06.434036 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:39:06.434779 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-26 08:39:06.443642 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-26 08:39:06.443705 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-26 08:39:06.443755 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-26 08:39:10.208250 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 3.76 seconds
2021-06-26 08:39:10.217248 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-26 08:39:10.442808 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:39:10.456430 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:39:10.456585 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public_dbt_test__audit"} */

    show terse objects in test_dbt.public_dbt_test__audit
2021-06-26 08:39:10.456716 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:39:11.974818 (ThreadPoolExecutor-1_0): Snowflake query id: 019d2e87-3200-5156-0000-65a900026b06
2021-06-26 08:39:11.975290 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-06-26 08:39:11.975793 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-06-26 08:39:11.975954 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-06-26 08:39:11.976482 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: Close
2021-06-26 08:39:12.287478 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-26 08:39:12.292686 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-26 08:39:12.292991 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-26 08:39:12.293198 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:39:12.965604 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.67 seconds
2021-06-26 08:39:12.969808 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-26 08:39:13.178678 (MainThread): Using snowflake connection "master".
2021-06-26 08:39:13.178998 (MainThread): On master: BEGIN
2021-06-26 08:39:13.179209 (MainThread): Opening a new connection, currently in state init
2021-06-26 08:39:13.804637 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-06-26 08:39:13.805639 (MainThread): On master: COMMIT
2021-06-26 08:39:13.806225 (MainThread): Using snowflake connection "master".
2021-06-26 08:39:13.806430 (MainThread): On master: COMMIT
2021-06-26 08:39:13.992379 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-06-26 08:39:13.994356 (MainThread): On master: Close
2021-06-26 08:39:14.182283 (MainThread): 16:39:14 | Concurrency: 1 threads (target='dev')
2021-06-26 08:39:14.182692 (MainThread): 16:39:14 | 
2021-06-26 08:39:14.185466 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-26 08:39:14.185987 (Thread-1): 16:39:14 | 1 of 4 START view model public.stg_customers......................... [RUN]
2021-06-26 08:39:14.186630 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:39:14.186873 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-26 08:39:14.191922 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-26 08:39:14.193618 (Thread-1): finished collecting timing info
2021-06-26 08:39:14.229739 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-06-26 08:39:14.232577 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:39:14.232671 (Thread-1): On model.my_new_project.stg_customers: BEGIN
2021-06-26 08:39:14.232754 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:39:14.866772 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2021-06-26 08:39:14.867328 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:39:14.867535 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view test_dbt.public.stg_customers  as (
    with 

source as (

    select * from test_raw.public.customers

),

cleaned as (
    
    select

    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
            
    from source

)

select * from cleaned
  );
2021-06-26 08:39:15.193741 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-06-26 08:39:15.198034 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-26 08:39:15.198433 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:39:15.198569 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-26 08:39:15.310379 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-06-26 08:39:15.329566 (Thread-1): finished collecting timing info
2021-06-26 08:39:15.329870 (Thread-1): On model.my_new_project.stg_customers: Close
2021-06-26 08:39:15.524214 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34b874ab-04cc-44bf-90a1-5b77ba1dd7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1176f07c0>]}
2021-06-26 08:39:15.525305 (Thread-1): 16:39:15 | 1 of 4 OK created view model public.stg_customers.................... [SUCCESS 1 in 1.34s]
2021-06-26 08:39:15.525646 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-26 08:39:15.525963 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-26 08:39:15.527156 (Thread-1): 16:39:15 | 2 of 4 START view model public.stg_orders............................ [RUN]
2021-06-26 08:39:15.527691 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:39:15.527883 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-26 08:39:15.532133 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-26 08:39:15.532925 (Thread-1): finished collecting timing info
2021-06-26 08:39:15.536851 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-06-26 08:39:15.538839 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:39:15.538970 (Thread-1): On model.my_new_project.stg_orders: BEGIN
2021-06-26 08:39:15.539101 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:39:16.157650 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-06-26 08:39:16.158623 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:39:16.158948 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view test_dbt.public.stg_orders  as (
    with 

source as (

    select * from test_raw.public.orders

),

cleaned as (
    
    select

    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
            
    from source

)

select * from cleaned
  );
2021-06-26 08:39:16.506158 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-06-26 08:39:16.509675 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-26 08:39:16.510044 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:39:16.510386 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-26 08:39:16.614536 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-06-26 08:39:16.618222 (Thread-1): finished collecting timing info
2021-06-26 08:39:16.618800 (Thread-1): On model.my_new_project.stg_orders: Close
2021-06-26 08:39:16.822533 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34b874ab-04cc-44bf-90a1-5b77ba1dd7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177d5670>]}
2021-06-26 08:39:16.823215 (Thread-1): 16:39:16 | 2 of 4 OK created view model public.stg_orders....................... [SUCCESS 1 in 1.29s]
2021-06-26 08:39:16.823469 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-26 08:39:16.823709 (Thread-1): Began running node model.my_new_project.stg_order_details
2021-06-26 08:39:16.824382 (Thread-1): 16:39:16 | 3 of 4 START view model public.stg_order_details..................... [RUN]
2021-06-26 08:39:16.825253 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:39:16.825476 (Thread-1): Compiling model.my_new_project.stg_order_details
2021-06-26 08:39:16.829872 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_order_details"
2021-06-26 08:39:16.831924 (Thread-1): finished collecting timing info
2021-06-26 08:39:16.835626 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_order_details"
2021-06-26 08:39:16.837328 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:39:16.837453 (Thread-1): On model.my_new_project.stg_order_details: BEGIN
2021-06-26 08:39:16.837577 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:39:17.507185 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-06-26 08:39:17.508082 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:39:17.508367 (Thread-1): On model.my_new_project.stg_order_details: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_order_details"} */

  create or replace  view test_dbt.public.stg_order_details  as (
    with 

source as (

    select * from test_raw.public.order_details

),

cleaned as (
    
    select

    orderid AS order_id,
    productid AS product_id,
    unitprice,
    quantity,
    discount
     
    from source

)

select * from cleaned
  );
2021-06-26 08:39:17.795948 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-06-26 08:39:17.801267 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-26 08:39:17.801843 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:39:17.802048 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-26 08:39:17.915124 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-06-26 08:39:17.919099 (Thread-1): finished collecting timing info
2021-06-26 08:39:17.919599 (Thread-1): On model.my_new_project.stg_order_details: Close
2021-06-26 08:39:18.123596 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34b874ab-04cc-44bf-90a1-5b77ba1dd7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177ac250>]}
2021-06-26 08:39:18.124725 (Thread-1): 16:39:18 | 3 of 4 OK created view model public.stg_order_details................ [SUCCESS 1 in 1.30s]
2021-06-26 08:39:18.125213 (Thread-1): Finished running node model.my_new_project.stg_order_details
2021-06-26 08:39:18.125552 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-26 08:39:18.126447 (Thread-1): 16:39:18 | 4 of 4 START view model public.customer_orders....................... [RUN]
2021-06-26 08:39:18.127046 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:39:18.127220 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-26 08:39:18.132154 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-26 08:39:18.133020 (Thread-1): finished collecting timing info
2021-06-26 08:39:18.137049 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-26 08:39:18.139808 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:39:18.139935 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-26 08:39:18.140057 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:39:18.761328 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-06-26 08:39:18.762244 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:39:18.762535 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with 

customers as (
    select * from test_dbt.public.stg_customers
),

orders as (
    select * from test_dbt.public.stg_orders
),

cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from orders
    group by 1
),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from orders
    inner join cte_customer_orders on orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-26 08:39:19.112955 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-06-26 08:39:19.117899 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-26 08:39:19.118444 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:39:19.118575 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-26 08:39:19.225141 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-06-26 08:39:19.228539 (Thread-1): finished collecting timing info
2021-06-26 08:39:19.228936 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-26 08:39:19.410512 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34b874ab-04cc-44bf-90a1-5b77ba1dd7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115970d60>]}
2021-06-26 08:39:19.411493 (Thread-1): 16:39:19 | 4 of 4 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.28s]
2021-06-26 08:39:19.411807 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-26 08:39:19.414145 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:39:19.414508 (MainThread): Using snowflake connection "master".
2021-06-26 08:39:19.414655 (MainThread): On master: BEGIN
2021-06-26 08:39:19.414798 (MainThread): Opening a new connection, currently in state closed
2021-06-26 08:39:20.033044 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2021-06-26 08:39:20.034045 (MainThread): On master: COMMIT
2021-06-26 08:39:20.034684 (MainThread): Using snowflake connection "master".
2021-06-26 08:39:20.034994 (MainThread): On master: COMMIT
2021-06-26 08:39:20.201430 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-26 08:39:20.202541 (MainThread): On master: Close
2021-06-26 08:39:20.386594 (MainThread): 16:39:20 | 
2021-06-26 08:39:20.386966 (MainThread): 16:39:20 | Finished running 4 view models in 13.95s.
2021-06-26 08:39:20.387167 (MainThread): Connection 'master' was properly closed.
2021-06-26 08:39:20.387293 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-26 08:39:20.398299 (MainThread): 
2021-06-26 08:39:20.398536 (MainThread): Completed successfully
2021-06-26 08:39:20.398699 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-26 08:39:20.398956 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177a92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177a9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11149b910>]}
2021-06-26 08:39:20.399272 (MainThread): Flushing usage events
2021-06-26 08:44:01.697116 (MainThread): Running with dbt=0.20.0-rc1
2021-06-26 08:44:02.264486 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-26 08:44:02.265344 (MainThread): Tracking: tracking
2021-06-26 08:44:02.265692 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2ac70>]}
2021-06-26 08:44:02.275797 (MainThread): Partial parsing not enabled
2021-06-26 08:44:02.290950 (MainThread): Parsing macros/catalog.sql
2021-06-26 08:44:02.293064 (MainThread): Parsing macros/adapters.sql
2021-06-26 08:44:02.317080 (MainThread): Parsing macros/materializations/merge.sql
2021-06-26 08:44:02.318518 (MainThread): Parsing macros/materializations/view.sql
2021-06-26 08:44:02.319491 (MainThread): Parsing macros/materializations/table.sql
2021-06-26 08:44:02.322367 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-26 08:44:02.329127 (MainThread): Parsing macros/core.sql
2021-06-26 08:44:02.331876 (MainThread): Parsing macros/materializations/test.sql
2021-06-26 08:44:02.335859 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-26 08:44:02.343431 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-26 08:44:02.344609 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-26 08:44:02.357930 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-26 08:44:02.387257 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-26 08:44:02.404415 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-26 08:44:02.405666 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-26 08:44:02.411673 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-26 08:44:02.423250 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-26 08:44:02.428864 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-26 08:44:02.433809 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-26 08:44:02.437359 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-26 08:44:02.437934 (MainThread): Parsing macros/etc/query.sql
2021-06-26 08:44:02.438561 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-26 08:44:02.439639 (MainThread): Parsing macros/etc/datetime.sql
2021-06-26 08:44:02.446479 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-26 08:44:02.447773 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-26 08:44:02.448840 (MainThread): Parsing macros/adapters/common.sql
2021-06-26 08:44:02.487356 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-26 08:44:02.488596 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-26 08:44:02.489379 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-26 08:44:02.490310 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-26 08:44:02.609386 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:44:02.616100 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:44:02.618392 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:44:02.620502 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:44:02.639269 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:44:02.640481 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:44:02.656715 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-26 08:44:02.660167 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96a52be0-e3cb-4e78-bac8-eed179ec0a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b69520>]}
2021-06-26 08:44:02.664040 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96a52be0-e3cb-4e78-bac8-eed179ec0a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111baba00>]}
2021-06-26 08:44:02.664178 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 149 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-26 08:44:02.664961 (MainThread): 
2021-06-26 08:44:02.665127 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:44:02.665800 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-26 08:44:02.674531 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-26 08:44:02.674593 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-26 08:44:02.674646 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-26 08:44:03.808205 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.13 seconds
2021-06-26 08:44:03.813644 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-26 08:44:04.067551 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:44:04.080832 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:44:04.081006 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public_dbt_test__audit"} */

    show terse objects in test_dbt.public_dbt_test__audit
2021-06-26 08:44:04.081146 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:44:04.719532 (ThreadPoolExecutor-1_0): Snowflake query id: 019d2e8c-3200-5157-0000-65a900023caa
2021-06-26 08:44:04.719775 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-06-26 08:44:04.720080 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-06-26 08:44:04.720203 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-06-26 08:44:04.720450 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: Close
2021-06-26 08:44:04.909564 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-26 08:44:04.913286 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-26 08:44:04.913485 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-26 08:44:04.913642 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:44:06.084972 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.17 seconds
2021-06-26 08:44:06.087714 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-26 08:44:06.286927 (MainThread): Using snowflake connection "master".
2021-06-26 08:44:06.287198 (MainThread): On master: BEGIN
2021-06-26 08:44:06.287357 (MainThread): Opening a new connection, currently in state init
2021-06-26 08:44:06.956765 (MainThread): SQL status: SUCCESS 1 in 0.67 seconds
2021-06-26 08:44:06.957531 (MainThread): On master: COMMIT
2021-06-26 08:44:06.957870 (MainThread): Using snowflake connection "master".
2021-06-26 08:44:06.958010 (MainThread): On master: COMMIT
2021-06-26 08:44:07.133022 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-26 08:44:07.133941 (MainThread): On master: Close
2021-06-26 08:44:07.332025 (MainThread): 16:44:07 | Concurrency: 1 threads (target='dev')
2021-06-26 08:44:07.332437 (MainThread): 16:44:07 | 
2021-06-26 08:44:07.334864 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-26 08:44:07.335346 (Thread-1): 16:44:07 | 1 of 4 START view model public.stg_customers......................... [RUN]
2021-06-26 08:44:07.335873 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:44:07.336191 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-26 08:44:07.341160 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-26 08:44:07.343169 (Thread-1): finished collecting timing info
2021-06-26 08:44:07.378809 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-06-26 08:44:07.380205 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:44:07.380296 (Thread-1): On model.my_new_project.stg_customers: BEGIN
2021-06-26 08:44:07.380379 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:44:08.127621 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-06-26 08:44:08.128450 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:44:08.128661 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view test_dbt.public.stg_customers  as (
    with 

source as (

    select * from test_raw.public.customers

),

cleaned as (
    
    select

    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
            
    from source

)

select * from cleaned
  );
2021-06-26 08:44:09.287865 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-06-26 08:44:09.290747 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-26 08:44:09.291051 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:44:09.291207 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-26 08:44:09.405578 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-06-26 08:44:09.418464 (Thread-1): finished collecting timing info
2021-06-26 08:44:09.418730 (Thread-1): On model.my_new_project.stg_customers: Close
2021-06-26 08:44:09.692253 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a52be0-e3cb-4e78-bac8-eed179ec0a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e4c730>]}
2021-06-26 08:44:09.693165 (Thread-1): 16:44:09 | 1 of 4 OK created view model public.stg_customers.................... [SUCCESS 1 in 2.36s]
2021-06-26 08:44:09.693485 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-26 08:44:09.693719 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-26 08:44:09.694040 (Thread-1): 16:44:09 | 2 of 4 START view model public.stg_orders............................ [RUN]
2021-06-26 08:44:09.695166 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:44:09.695396 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-26 08:44:09.699748 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-26 08:44:09.700494 (Thread-1): finished collecting timing info
2021-06-26 08:44:09.704207 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-06-26 08:44:09.705835 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:44:09.705956 (Thread-1): On model.my_new_project.stg_orders: BEGIN
2021-06-26 08:44:09.706078 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:44:10.377328 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-06-26 08:44:10.378328 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:44:10.378497 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view test_dbt.public.stg_orders  as (
    with 

source as (

    select * from test_raw.public.orders

),

cleaned as (
    
    select

    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
            
    from source

)

select * from cleaned
  );
2021-06-26 08:44:11.030711 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-06-26 08:44:11.034698 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-26 08:44:11.035124 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:44:11.035263 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-26 08:44:11.143894 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-06-26 08:44:11.148019 (Thread-1): finished collecting timing info
2021-06-26 08:44:11.148759 (Thread-1): On model.my_new_project.stg_orders: Close
2021-06-26 08:44:11.394811 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a52be0-e3cb-4e78-bac8-eed179ec0a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d39250>]}
2021-06-26 08:44:11.395805 (Thread-1): 16:44:11 | 2 of 4 OK created view model public.stg_orders....................... [SUCCESS 1 in 1.70s]
2021-06-26 08:44:11.396121 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-26 08:44:11.396425 (Thread-1): Began running node model.my_new_project.stg_order_details
2021-06-26 08:44:11.397072 (Thread-1): 16:44:11 | 3 of 4 START view model public.stg_order_details..................... [RUN]
2021-06-26 08:44:11.397707 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:44:11.397948 (Thread-1): Compiling model.my_new_project.stg_order_details
2021-06-26 08:44:11.402586 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_order_details"
2021-06-26 08:44:11.404218 (Thread-1): finished collecting timing info
2021-06-26 08:44:11.407724 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_order_details"
2021-06-26 08:44:11.409463 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:44:11.409587 (Thread-1): On model.my_new_project.stg_order_details: BEGIN
2021-06-26 08:44:11.409712 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:44:12.006133 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2021-06-26 08:44:12.006875 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:44:12.007036 (Thread-1): On model.my_new_project.stg_order_details: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_order_details"} */

  create or replace  view test_dbt.public.stg_order_details  as (
    with 

source as (

    select * from test_raw.public.order_details

),

cleaned as (
    
    select

    orderid AS order_id,
    productid AS product_id,
    unitprice,
    quantity,
    discount
     
    from source

)

select * from cleaned
  );
2021-06-26 08:44:12.303924 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-06-26 08:44:12.307635 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-26 08:44:12.308138 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:44:12.308304 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-26 08:44:12.427484 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-06-26 08:44:12.430861 (Thread-1): finished collecting timing info
2021-06-26 08:44:12.431291 (Thread-1): On model.my_new_project.stg_order_details: Close
2021-06-26 08:44:12.631774 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a52be0-e3cb-4e78-bac8-eed179ec0a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d81b50>]}
2021-06-26 08:44:12.632953 (Thread-1): 16:44:12 | 3 of 4 OK created view model public.stg_order_details................ [SUCCESS 1 in 1.23s]
2021-06-26 08:44:12.633182 (Thread-1): Finished running node model.my_new_project.stg_order_details
2021-06-26 08:44:12.633417 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-26 08:44:12.633957 (Thread-1): 16:44:12 | 4 of 4 START view model public.customer_orders....................... [RUN]
2021-06-26 08:44:12.634690 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:44:12.634868 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-26 08:44:12.638439 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-26 08:44:12.640673 (Thread-1): finished collecting timing info
2021-06-26 08:44:12.643331 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-26 08:44:12.645226 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:44:12.645326 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-26 08:44:12.645422 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:44:13.344539 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2021-06-26 08:44:13.344889 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:44:13.345025 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with 

customers as (
    select * from test_dbt.public.stg_customers
),

orders as (
    select * from test_dbt.public.stg_orders
),

cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from orders
    group by 1
),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from orders
    inner join cte_customer_orders on orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-26 08:44:13.719716 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-06-26 08:44:13.723456 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-26 08:44:13.724194 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:44:13.724499 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-26 08:44:13.971962 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-06-26 08:44:13.973877 (Thread-1): finished collecting timing info
2021-06-26 08:44:13.974238 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-26 08:44:14.352661 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a52be0-e3cb-4e78-bac8-eed179ec0a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d32190>]}
2021-06-26 08:44:14.353749 (Thread-1): 16:44:14 | 4 of 4 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.72s]
2021-06-26 08:44:14.354119 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-26 08:44:14.356727 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:44:14.357146 (MainThread): Using snowflake connection "master".
2021-06-26 08:44:14.357297 (MainThread): On master: BEGIN
2021-06-26 08:44:14.357444 (MainThread): Opening a new connection, currently in state closed
2021-06-26 08:44:15.524746 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2021-06-26 08:44:15.525712 (MainThread): On master: COMMIT
2021-06-26 08:44:15.526164 (MainThread): Using snowflake connection "master".
2021-06-26 08:44:15.526386 (MainThread): On master: COMMIT
2021-06-26 08:44:15.711015 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2021-06-26 08:44:15.711852 (MainThread): On master: Close
2021-06-26 08:44:15.910520 (MainThread): 16:44:15 | 
2021-06-26 08:44:15.910906 (MainThread): 16:44:15 | Finished running 4 view models in 13.25s.
2021-06-26 08:44:15.911098 (MainThread): Connection 'master' was properly closed.
2021-06-26 08:44:15.911224 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-26 08:44:15.920652 (MainThread): 
2021-06-26 08:44:15.920942 (MainThread): Completed successfully
2021-06-26 08:44:15.921142 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-26 08:44:15.921450 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a30880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b69400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b69ac0>]}
2021-06-26 08:44:15.921818 (MainThread): Flushing usage events
2021-06-26 08:44:52.973203 (MainThread): Running with dbt=0.20.0-rc1
2021-06-26 08:44:53.499727 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-26 08:44:53.500603 (MainThread): Tracking: tracking
2021-06-26 08:44:53.500863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110711bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a50c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a50d00>]}
2021-06-26 08:44:53.510607 (MainThread): Partial parsing not enabled
2021-06-26 08:44:53.516526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a50df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a813d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a81520>]}
2021-06-26 08:44:53.516698 (MainThread): Flushing usage events
2021-06-26 08:44:54.814839 (MainThread): Encountered an error:
2021-06-26 08:44:54.815319 (MainThread): Compilation Error
  Error reading my_new_project: staging/customer_data/stg_cutomers.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         tests:
    10 |           - unique
    11 |           - not_null
    12 |        - name: city
    13 |         description: City
    14 |         tests:
    15 |           - unique
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7:
              - name: customer_id
              ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 12, column 8:
               - name: city
               ^
2021-06-26 08:44:54.819295 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 82, in compose_node
    node = self.compose_sequence_node(anchor)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 111, in compose_sequence_node
    node.value.append(self.compose_node(node, index))
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 82, in compose_node
    node = self.compose_sequence_node(anchor)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 110, in compose_sequence_node
    while not self.check_event(SequenceEndEvent):
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 392, in parse_block_sequence_entry
    raise ParserError("while parsing a block collection", self.marks[-1],
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 7, column 7:
          - name: customer_id
          ^
expected <block end>, but found '<block sequence start>'
  in "<unicode string>", line 12, column 8:
           - name: city
           ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 101, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 12
  ------------------------------
  9  |         tests:
  10 |           - unique
  11 |           - not_null
  12 |        - name: city
  13 |         description: City
  14 |         tests:
  15 |           - unique
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 7, column 7:
            - name: customer_id
            ^
  expected <block end>, but found '<block sequence start>'
    in "<unicode string>", line 12, column 8:
             - name: city
             ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 168, in get_full_manifest
    manifest = loader.load()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 198, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/parser/read_files.py", line 105, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/parser/read_files.py", line 60, in read_files_for_parser
    source_files = get_source_files(
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/parser/read_files.py", line 53, in get_source_files
    fb_list.append(load_source_file(
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/parser/read_files.py", line 21, in load_source_file
    source_file.dfy = yaml_from_file(source_file)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 104, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: staging/customer_data/stg_cutomers.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         tests:
    10 |           - unique
    11 |           - not_null
    12 |        - name: city
    13 |         description: City
    14 |         tests:
    15 |           - unique
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7:
              - name: customer_id
              ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 12, column 8:
               - name: city
               ^

2021-06-26 08:45:40.455599 (MainThread): Running with dbt=0.20.0-rc1
2021-06-26 08:45:41.004048 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-26 08:45:41.005521 (MainThread): Tracking: tracking
2021-06-26 08:45:41.005861 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb31460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe70c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe70cd0>]}
2021-06-26 08:45:41.016939 (MainThread): Partial parsing not enabled
2021-06-26 08:45:41.030143 (MainThread): Parsing macros/catalog.sql
2021-06-26 08:45:41.032186 (MainThread): Parsing macros/adapters.sql
2021-06-26 08:45:41.055055 (MainThread): Parsing macros/materializations/merge.sql
2021-06-26 08:45:41.056491 (MainThread): Parsing macros/materializations/view.sql
2021-06-26 08:45:41.057454 (MainThread): Parsing macros/materializations/table.sql
2021-06-26 08:45:41.060349 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-26 08:45:41.067134 (MainThread): Parsing macros/core.sql
2021-06-26 08:45:41.069911 (MainThread): Parsing macros/materializations/test.sql
2021-06-26 08:45:41.073981 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-26 08:45:41.081435 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-26 08:45:41.082594 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-26 08:45:41.095700 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-26 08:45:41.124178 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-26 08:45:41.140717 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-26 08:45:41.141966 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-26 08:45:41.147695 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-26 08:45:41.158684 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-26 08:45:41.164223 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-26 08:45:41.169029 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-26 08:45:41.172515 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-26 08:45:41.173089 (MainThread): Parsing macros/etc/query.sql
2021-06-26 08:45:41.173722 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-26 08:45:41.174793 (MainThread): Parsing macros/etc/datetime.sql
2021-06-26 08:45:41.181331 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-26 08:45:41.182633 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-26 08:45:41.183699 (MainThread): Parsing macros/adapters/common.sql
2021-06-26 08:45:41.219590 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-26 08:45:41.220783 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-26 08:45:41.221562 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-26 08:45:41.222463 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-26 08:45:41.341660 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:45:41.348419 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:45:41.350711 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:45:41.352791 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:45:41.373036 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:45:41.374250 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:45:41.389928 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-26 08:45:41.393377 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4209e3c-9877-4489-9e11-8f4208995ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffa6550>]}
2021-06-26 08:45:41.397767 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4209e3c-9877-4489-9e11-8f4208995ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffe89d0>]}
2021-06-26 08:45:41.397907 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 149 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-26 08:45:41.398667 (MainThread): 
2021-06-26 08:45:41.398832 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:45:41.400617 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-26 08:45:41.409690 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-26 08:45:41.418692 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-26 08:45:41.418810 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-26 08:45:42.348417 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.93 seconds
2021-06-26 08:45:42.358603 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-26 08:45:42.567477 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:45:42.580604 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:45:42.580771 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public_dbt_test__audit"} */

    show terse objects in test_dbt.public_dbt_test__audit
2021-06-26 08:45:42.580913 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:45:43.524251 (ThreadPoolExecutor-1_0): Snowflake query id: 019d2e8d-3200-5157-0000-65a900023cca
2021-06-26 08:45:43.524538 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-06-26 08:45:43.524894 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-06-26 08:45:43.525023 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-06-26 08:45:43.525314 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: Close
2021-06-26 08:45:43.713670 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-26 08:45:43.716958 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-26 08:45:43.717131 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-26 08:45:43.717285 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:45:44.325477 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.61 seconds
2021-06-26 08:45:44.330641 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-26 08:45:44.550355 (MainThread): Using snowflake connection "master".
2021-06-26 08:45:44.550798 (MainThread): On master: BEGIN
2021-06-26 08:45:44.551020 (MainThread): Opening a new connection, currently in state init
2021-06-26 08:45:45.221729 (MainThread): SQL status: SUCCESS 1 in 0.67 seconds
2021-06-26 08:45:45.222666 (MainThread): On master: COMMIT
2021-06-26 08:45:45.223154 (MainThread): Using snowflake connection "master".
2021-06-26 08:45:45.223357 (MainThread): On master: COMMIT
2021-06-26 08:45:45.407470 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2021-06-26 08:45:45.408486 (MainThread): On master: Close
2021-06-26 08:45:45.600257 (MainThread): 16:45:45 | Concurrency: 1 threads (target='dev')
2021-06-26 08:45:45.600719 (MainThread): 16:45:45 | 
2021-06-26 08:45:45.603136 (Thread-1): Began running node model.my_new_project.stg_customers
2021-06-26 08:45:45.603638 (Thread-1): 16:45:45 | 1 of 4 START view model public.stg_customers......................... [RUN]
2021-06-26 08:45:45.604207 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:45:45.604410 (Thread-1): Compiling model.my_new_project.stg_customers
2021-06-26 08:45:45.609220 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-06-26 08:45:45.610746 (Thread-1): finished collecting timing info
2021-06-26 08:45:45.647036 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-06-26 08:45:45.648637 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:45:45.648724 (Thread-1): On model.my_new_project.stg_customers: BEGIN
2021-06-26 08:45:45.648805 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:45:46.256018 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-06-26 08:45:46.256853 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:45:46.257128 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */

  create or replace  view test_dbt.public.stg_customers  as (
    with 

source as (

    select * from test_raw.public.customers

),

cleaned as (
    
    select

    customerid AS customer_id, 
    contactname,
    contacttitle AS title,
    country,
    city
            
    from source

)

select * from cleaned
  );
2021-06-26 08:45:46.699106 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-06-26 08:45:46.704454 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-26 08:45:46.704899 (Thread-1): Using snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:45:46.705033 (Thread-1): On model.my_new_project.stg_customers: COMMIT
2021-06-26 08:45:46.865348 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-06-26 08:45:46.881513 (Thread-1): finished collecting timing info
2021-06-26 08:45:46.881789 (Thread-1): On model.my_new_project.stg_customers: Close
2021-06-26 08:45:47.151184 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4209e3c-9877-4489-9e11-8f4208995ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11022e820>]}
2021-06-26 08:45:47.151944 (Thread-1): 16:45:47 | 1 of 4 OK created view model public.stg_customers.................... [SUCCESS 1 in 1.55s]
2021-06-26 08:45:47.152242 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-06-26 08:45:47.152535 (Thread-1): Began running node model.my_new_project.stg_orders
2021-06-26 08:45:47.152885 (Thread-1): 16:45:47 | 2 of 4 START view model public.stg_orders............................ [RUN]
2021-06-26 08:45:47.153930 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:45:47.154117 (Thread-1): Compiling model.my_new_project.stg_orders
2021-06-26 08:45:47.158277 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-06-26 08:45:47.159023 (Thread-1): finished collecting timing info
2021-06-26 08:45:47.162786 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-06-26 08:45:47.164281 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:45:47.164399 (Thread-1): On model.my_new_project.stg_orders: BEGIN
2021-06-26 08:45:47.164516 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:45:47.783963 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-06-26 08:45:47.784693 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:45:47.784854 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */

  create or replace  view test_dbt.public.stg_orders  as (
    with 

source as (

    select * from test_raw.public.orders

),

cleaned as (
    
    select

    orderid AS order_id,
    customerid AS customer_id,
    orderdate AS order_date  
            
    from source

)

select * from cleaned
  );
2021-06-26 08:45:48.053579 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-06-26 08:45:48.058614 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-26 08:45:48.059230 (Thread-1): Using snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:45:48.059362 (Thread-1): On model.my_new_project.stg_orders: COMMIT
2021-06-26 08:45:48.170525 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-06-26 08:45:48.173955 (Thread-1): finished collecting timing info
2021-06-26 08:45:48.174446 (Thread-1): On model.my_new_project.stg_orders: Close
2021-06-26 08:45:48.361828 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4209e3c-9877-4489-9e11-8f4208995ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a0250>]}
2021-06-26 08:45:48.362537 (Thread-1): 16:45:48 | 2 of 4 OK created view model public.stg_orders....................... [SUCCESS 1 in 1.21s]
2021-06-26 08:45:48.362785 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-06-26 08:45:48.363026 (Thread-1): Began running node model.my_new_project.stg_order_details
2021-06-26 08:45:48.363416 (Thread-1): 16:45:48 | 3 of 4 START view model public.stg_order_details..................... [RUN]
2021-06-26 08:45:48.364130 (Thread-1): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:45:48.364351 (Thread-1): Compiling model.my_new_project.stg_order_details
2021-06-26 08:45:48.368729 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_order_details"
2021-06-26 08:45:48.369573 (Thread-1): finished collecting timing info
2021-06-26 08:45:48.372817 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_order_details"
2021-06-26 08:45:48.374379 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:45:48.374495 (Thread-1): On model.my_new_project.stg_order_details: BEGIN
2021-06-26 08:45:48.374616 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:45:48.952412 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-06-26 08:45:48.952897 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:45:48.953035 (Thread-1): On model.my_new_project.stg_order_details: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.stg_order_details"} */

  create or replace  view test_dbt.public.stg_order_details  as (
    with 

source as (

    select * from test_raw.public.order_details

),

cleaned as (
    
    select

    orderid AS order_id,
    productid AS product_id,
    unitprice,
    quantity,
    discount
     
    from source

)

select * from cleaned
  );
2021-06-26 08:45:49.244823 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-06-26 08:45:49.248407 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-26 08:45:49.248868 (Thread-1): Using snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:45:49.249054 (Thread-1): On model.my_new_project.stg_order_details: COMMIT
2021-06-26 08:45:49.420583 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-26 08:45:49.423225 (Thread-1): finished collecting timing info
2021-06-26 08:45:49.423661 (Thread-1): On model.my_new_project.stg_order_details: Close
2021-06-26 08:45:49.604937 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4209e3c-9877-4489-9e11-8f4208995ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110234cd0>]}
2021-06-26 08:45:49.605588 (Thread-1): 16:45:49 | 3 of 4 OK created view model public.stg_order_details................ [SUCCESS 1 in 1.24s]
2021-06-26 08:45:49.605821 (Thread-1): Finished running node model.my_new_project.stg_order_details
2021-06-26 08:45:49.606062 (Thread-1): Began running node model.my_new_project.customer_orders
2021-06-26 08:45:49.606624 (Thread-1): 16:45:49 | 4 of 4 START view model public.customer_orders....................... [RUN]
2021-06-26 08:45:49.607283 (Thread-1): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:45:49.607530 (Thread-1): Compiling model.my_new_project.customer_orders
2021-06-26 08:45:49.611933 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_orders"
2021-06-26 08:45:49.612552 (Thread-1): finished collecting timing info
2021-06-26 08:45:49.615910 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_orders"
2021-06-26 08:45:49.618411 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:45:49.618533 (Thread-1): On model.my_new_project.customer_orders: BEGIN
2021-06-26 08:45:49.618667 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:45:50.306730 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-06-26 08:45:50.307617 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:45:50.307900 (Thread-1): On model.my_new_project.customer_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_orders"} */

  create or replace  view test_dbt.public.customer_orders  as (
    with 

customers as (
    select * from test_dbt.public.stg_customers
),

orders as (
    select * from test_dbt.public.stg_orders
),

cte_customer_orders as (
  select 
    customer_id,
    min(order_date) AS first_order,
    max(order_date) latest_order
    from orders
    group by 1
),
  
  final as (
    
    select order_id, cte_customer_orders.customer_id, first_order, latest_order from orders
    inner join cte_customer_orders on orders.customer_id = cte_customer_orders.customer_id
  
  )


select * from final
  );
2021-06-26 08:45:50.638421 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-06-26 08:45:50.641766 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-26 08:45:50.642198 (Thread-1): Using snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:45:50.642379 (Thread-1): On model.my_new_project.customer_orders: COMMIT
2021-06-26 08:45:50.757429 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-06-26 08:45:50.760958 (Thread-1): finished collecting timing info
2021-06-26 08:45:50.761471 (Thread-1): On model.my_new_project.customer_orders: Close
2021-06-26 08:45:50.963036 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4209e3c-9877-4489-9e11-8f4208995ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11024bf70>]}
2021-06-26 08:45:50.963702 (Thread-1): 16:45:50 | 4 of 4 OK created view model public.customer_orders.................. [SUCCESS 1 in 1.36s]
2021-06-26 08:45:50.963951 (Thread-1): Finished running node model.my_new_project.customer_orders
2021-06-26 08:45:50.966143 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:45:50.966517 (MainThread): Using snowflake connection "master".
2021-06-26 08:45:50.966660 (MainThread): On master: BEGIN
2021-06-26 08:45:50.966804 (MainThread): Opening a new connection, currently in state closed
2021-06-26 08:45:51.570431 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2021-06-26 08:45:51.571398 (MainThread): On master: COMMIT
2021-06-26 08:45:51.571992 (MainThread): Using snowflake connection "master".
2021-06-26 08:45:51.572261 (MainThread): On master: COMMIT
2021-06-26 08:45:51.744033 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-06-26 08:45:51.744791 (MainThread): On master: Close
2021-06-26 08:45:51.942172 (MainThread): 16:45:51 | 
2021-06-26 08:45:51.942869 (MainThread): 16:45:51 | Finished running 4 view models in 10.54s.
2021-06-26 08:45:51.943277 (MainThread): Connection 'master' was properly closed.
2021-06-26 08:45:51.943452 (MainThread): Connection 'model.my_new_project.customer_orders' was properly closed.
2021-06-26 08:45:51.954116 (MainThread): 
2021-06-26 08:45:51.954450 (MainThread): Completed successfully
2021-06-26 08:45:51.954651 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-26 08:45:51.954937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11049d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe70cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11020b2b0>]}
2021-06-26 08:45:51.955220 (MainThread): Flushing usage events
2021-06-26 08:54:14.675649 (MainThread): Running with dbt=0.20.0-rc1
2021-06-26 08:54:15.228602 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-26 08:54:15.229519 (MainThread): Tracking: tracking
2021-06-26 08:54:15.229792 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110212d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111575c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111575d00>]}
2021-06-26 08:54:15.240013 (MainThread): Partial parsing not enabled
2021-06-26 08:54:15.254216 (MainThread): Parsing macros/catalog.sql
2021-06-26 08:54:15.256264 (MainThread): Parsing macros/adapters.sql
2021-06-26 08:54:15.280133 (MainThread): Parsing macros/materializations/merge.sql
2021-06-26 08:54:15.281563 (MainThread): Parsing macros/materializations/view.sql
2021-06-26 08:54:15.282543 (MainThread): Parsing macros/materializations/table.sql
2021-06-26 08:54:15.285474 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-26 08:54:15.292165 (MainThread): Parsing macros/core.sql
2021-06-26 08:54:15.294889 (MainThread): Parsing macros/materializations/test.sql
2021-06-26 08:54:15.298897 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-26 08:54:15.306464 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-26 08:54:15.307667 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-26 08:54:15.321063 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-26 08:54:15.352227 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-26 08:54:15.369577 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-26 08:54:15.370859 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-26 08:54:15.376720 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-26 08:54:15.388382 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-26 08:54:15.394152 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-26 08:54:15.399200 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-26 08:54:15.402761 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-26 08:54:15.403361 (MainThread): Parsing macros/etc/query.sql
2021-06-26 08:54:15.404005 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-26 08:54:15.405089 (MainThread): Parsing macros/etc/datetime.sql
2021-06-26 08:54:15.411866 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-26 08:54:15.413172 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-26 08:54:15.414244 (MainThread): Parsing macros/adapters/common.sql
2021-06-26 08:54:15.451855 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-26 08:54:15.453091 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-26 08:54:15.453855 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-26 08:54:15.454730 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-26 08:54:15.573212 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:54:15.579779 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:54:15.582056 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:54:15.584142 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:54:15.602750 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:54:15.603965 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:54:15.619815 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-26 08:54:15.623371 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c775911-2e80-4286-8e6d-fbd6e764fb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a3550>]}
2021-06-26 08:54:15.627144 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c775911-2e80-4286-8e6d-fbd6e764fb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116510a0>]}
2021-06-26 08:54:15.627286 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 149 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-26 08:54:15.628047 (MainThread): 
2021-06-26 08:54:15.628210 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:54:15.629031 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-26 08:54:15.637665 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-26 08:54:15.637728 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-26 08:54:15.637781 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-26 08:54:16.653800 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.02 seconds
2021-06-26 08:54:16.662175 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-26 08:54:16.862723 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:54:16.867307 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:54:16.867486 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public_dbt_test__audit"} */

    show terse objects in test_dbt.public_dbt_test__audit
2021-06-26 08:54:16.867644 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:54:17.487245 (ThreadPoolExecutor-1_0): Snowflake query id: 019d2e96-3200-5156-0000-65a900026c2a
2021-06-26 08:54:17.487609 (ThreadPoolExecutor-1_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-06-26 08:54:17.488005 (ThreadPoolExecutor-1_0): Error running SQL: macro list_relations_without_caching
2021-06-26 08:54:17.488164 (ThreadPoolExecutor-1_0): Rolling back transaction.
2021-06-26 08:54:17.488504 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: Close
2021-06-26 08:54:17.676777 (MainThread): 16:54:17 | Concurrency: 1 threads (target='dev')
2021-06-26 08:54:17.677105 (MainThread): 16:54:17 | 
2021-06-26 08:54:17.679393 (Thread-1): Began running node test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 08:54:17.679772 (Thread-1): 16:54:17 | 1 of 2 START test not_null_stg_customers_city........................ [RUN]
2021-06-26 08:54:17.680358 (Thread-1): Acquiring new snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:54:17.680655 (Thread-1): Compiling test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 08:54:17.694512 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"
2021-06-26 08:54:17.696043 (Thread-1): finished collecting timing info
2021-06-26 08:54:17.717383 (Thread-1): Writing runtime SQL for node "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"
2021-06-26 08:54:17.719079 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:54:17.719191 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: BEGIN
2021-06-26 08:54:17.719290 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:54:18.335774 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-06-26 08:54:18.336485 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:54:18.336707 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from test_dbt.public.stg_customers
where city is null



      
    ) dbt_internal_test
2021-06-26 08:54:18.614348 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-06-26 08:54:18.619699 (Thread-1): finished collecting timing info
2021-06-26 08:54:18.620097 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: ROLLBACK
2021-06-26 08:54:18.790415 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: Close
2021-06-26 08:54:18.983918 (Thread-1): 16:54:18 | 1 of 2 PASS not_null_stg_customers_city.............................. [PASS in 1.30s]
2021-06-26 08:54:18.984289 (Thread-1): Finished running node test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 08:54:18.984588 (Thread-1): Began running node test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 08:54:18.985569 (Thread-1): 16:54:18 | 2 of 2 START test unique_stg_customers_city.......................... [RUN]
2021-06-26 08:54:18.986098 (Thread-1): Acquiring new snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:54:18.986289 (Thread-1): Compiling test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 08:54:18.999086 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"
2021-06-26 08:54:18.999939 (Thread-1): finished collecting timing info
2021-06-26 08:54:19.002010 (Thread-1): Writing runtime SQL for node "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"
2021-06-26 08:54:19.003529 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:54:19.003657 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: BEGIN
2021-06-26 08:54:19.003786 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:54:19.826372 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-06-26 08:54:19.827101 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:54:19.827316 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    city,
    count(*) as n_records

from test_dbt.public.stg_customers
where city is not null
group by city
having count(*) > 1



      
    ) dbt_internal_test
2021-06-26 08:54:20.303506 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-06-26 08:54:20.305966 (Thread-1): finished collecting timing info
2021-06-26 08:54:20.306440 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: ROLLBACK
2021-06-26 08:54:20.486813 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: Close
2021-06-26 08:54:20.682287 (Thread-1): 16:54:20 | 2 of 2 FAIL 19 unique_stg_customers_city............................. [FAIL 19 in 1.70s]
2021-06-26 08:54:20.682672 (Thread-1): Finished running node test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 08:54:20.685110 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:54:20.685634 (MainThread): 16:54:20 | 
2021-06-26 08:54:20.685842 (MainThread): 16:54:20 | Finished running 2 tests in 5.06s.
2021-06-26 08:54:20.686141 (MainThread): Connection 'master' was properly closed.
2021-06-26 08:54:20.686386 (MainThread): Connection 'test.my_new_project.unique_stg_customers_city.d7a01e6fd1' was properly closed.
2021-06-26 08:54:20.696089 (MainThread): 
2021-06-26 08:54:20.696294 (MainThread): Completed with 1 error and 0 warnings:
2021-06-26 08:54:20.696434 (MainThread): 
2021-06-26 08:54:20.696576 (MainThread): Failure in test unique_stg_customers_city (models/staging/customer_data/stg_cutomers.yml)
2021-06-26 08:54:20.696698 (MainThread):   Got 19 results, configured to fail if != 0
2021-06-26 08:54:20.696814 (MainThread): 
2021-06-26 08:54:20.696934 (MainThread):   compiled SQL at target/compiled/my_new_project/models/staging/customer_data/stg_cutomers.yml/schema_test/unique_stg_customers_city.sql
2021-06-26 08:54:20.697097 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-06-26 08:54:20.697328 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11157eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11156ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110212d30>]}
2021-06-26 08:54:20.697601 (MainThread): Flushing usage events
2021-06-26 08:57:13.055377 (MainThread): Running with dbt=0.20.0-rc1
2021-06-26 08:57:13.614458 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=True, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-26 08:57:13.615245 (MainThread): Tracking: tracking
2021-06-26 08:57:13.615553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b8c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eabd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eabe20>]}
2021-06-26 08:57:13.625611 (MainThread): Partial parsing not enabled
2021-06-26 08:57:13.638635 (MainThread): Parsing macros/catalog.sql
2021-06-26 08:57:13.640610 (MainThread): Parsing macros/adapters.sql
2021-06-26 08:57:13.663646 (MainThread): Parsing macros/materializations/merge.sql
2021-06-26 08:57:13.665048 (MainThread): Parsing macros/materializations/view.sql
2021-06-26 08:57:13.665991 (MainThread): Parsing macros/materializations/table.sql
2021-06-26 08:57:13.668789 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-26 08:57:13.675371 (MainThread): Parsing macros/core.sql
2021-06-26 08:57:13.678068 (MainThread): Parsing macros/materializations/test.sql
2021-06-26 08:57:13.681951 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-26 08:57:13.689244 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-26 08:57:13.690404 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-26 08:57:13.703563 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-26 08:57:13.731409 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-26 08:57:13.747776 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-26 08:57:13.749020 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-26 08:57:13.754721 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-26 08:57:13.765678 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-26 08:57:13.771072 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-26 08:57:13.775809 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-26 08:57:13.779263 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-26 08:57:13.779830 (MainThread): Parsing macros/etc/query.sql
2021-06-26 08:57:13.780458 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-26 08:57:13.781515 (MainThread): Parsing macros/etc/datetime.sql
2021-06-26 08:57:13.788024 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-26 08:57:13.789308 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-26 08:57:13.790362 (MainThread): Parsing macros/adapters/common.sql
2021-06-26 08:57:13.826516 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-26 08:57:13.827711 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-26 08:57:13.828461 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-26 08:57:13.829330 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-26 08:57:13.948553 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 08:57:13.955389 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 08:57:13.957746 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 08:57:13.959860 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 08:57:13.979870 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:57:13.981120 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 08:57:13.996392 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-26 08:57:13.999997 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b510804b-aad3-483f-b7ab-ed189f48dcf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112006760>]}
2021-06-26 08:57:14.003758 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b510804b-aad3-483f-b7ab-ed189f48dcf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112046b20>]}
2021-06-26 08:57:14.003911 (MainThread): Found 4 models, 2 tests, 0 snapshots, 0 analyses, 149 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-26 08:57:14.004697 (MainThread): 
2021-06-26 08:57:14.004861 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:57:14.005476 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-26 08:57:14.014292 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-26 08:57:14.014354 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-26 08:57:14.014407 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-26 08:57:15.079866 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.07 seconds
2021-06-26 08:57:15.088313 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-26 08:57:15.296035 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_test_dbt_public_dbt_test__audit".
2021-06-26 08:57:15.296618 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_test_dbt_public_dbt_test__audit".
2021-06-26 08:57:15.296906 (ThreadPoolExecutor-0_0): Creating schema "test_dbt.public_dbt_test__audit"
2021-06-26 08:57:15.306725 (ThreadPoolExecutor-0_0): Using snowflake connection "create_test_dbt_public_dbt_test__audit".
2021-06-26 08:57:15.306877 (ThreadPoolExecutor-0_0): On create_test_dbt_public_dbt_test__audit: BEGIN
2021-06-26 08:57:15.307013 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-26 08:57:15.928489 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.62 seconds
2021-06-26 08:57:15.929159 (ThreadPoolExecutor-0_0): Using snowflake connection "create_test_dbt_public_dbt_test__audit".
2021-06-26 08:57:15.929368 (ThreadPoolExecutor-0_0): On create_test_dbt_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "create_test_dbt_public_dbt_test__audit"} */
create schema if not exists test_dbt.public_dbt_test__audit
2021-06-26 08:57:16.062155 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.13 seconds
2021-06-26 08:57:16.067247 (ThreadPoolExecutor-0_0): On create_test_dbt_public_dbt_test__audit: COMMIT
2021-06-26 08:57:16.067762 (ThreadPoolExecutor-0_0): Using snowflake connection "create_test_dbt_public_dbt_test__audit".
2021-06-26 08:57:16.067979 (ThreadPoolExecutor-0_0): On create_test_dbt_public_dbt_test__audit: COMMIT
2021-06-26 08:57:16.257934 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.19 seconds
2021-06-26 08:57:16.258871 (ThreadPoolExecutor-0_0): On create_test_dbt_public_dbt_test__audit: Close
2021-06-26 08:57:16.459644 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:57:16.470727 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 08:57:16.470926 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public_dbt_test__audit"} */

    show terse objects in test_dbt.public_dbt_test__audit
2021-06-26 08:57:16.471044 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:57:17.251697 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.78 seconds
2021-06-26 08:57:17.254396 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: Close
2021-06-26 08:57:17.464119 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-26 08:57:17.467819 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-26 08:57:17.467991 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-26 08:57:17.468150 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 08:57:18.118449 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.65 seconds
2021-06-26 08:57:18.123632 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-26 08:57:18.331065 (MainThread): 16:57:18 | Concurrency: 1 threads (target='dev')
2021-06-26 08:57:18.331420 (MainThread): 16:57:18 | 
2021-06-26 08:57:18.333710 (Thread-1): Began running node test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 08:57:18.334066 (Thread-1): 16:57:18 | 1 of 2 START test not_null_stg_customers_city........................ [RUN]
2021-06-26 08:57:18.334588 (Thread-1): Acquiring new snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:57:18.334864 (Thread-1): Compiling test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 08:57:18.347605 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"
2021-06-26 08:57:18.348354 (Thread-1): finished collecting timing info
2021-06-26 08:57:18.380318 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:57:18.380475 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: BEGIN
2021-06-26 08:57:18.380561 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:57:19.017432 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-06-26 08:57:19.018238 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:57:19.018451 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"} */

        

      create or replace transient table test_dbt.public_dbt_test__audit.not_null_stg_customers_city  as
      (
    
    

select *
from test_dbt.public.stg_customers
where city is null



      );
2021-06-26 08:57:19.653433 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2021-06-26 08:57:19.657034 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: COMMIT
2021-06-26 08:57:19.657327 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:57:19.657463 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: COMMIT
2021-06-26 08:57:19.771625 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-06-26 08:57:19.773578 (Thread-1): Writing runtime SQL for node "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"
2021-06-26 08:57:19.776807 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:57:19.777177 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: BEGIN
2021-06-26 08:57:19.913737 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-06-26 08:57:19.914337 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 08:57:19.914615 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from test_dbt.public_dbt_test__audit.not_null_stg_customers_city
    
      
    ) dbt_internal_test
2021-06-26 08:57:20.129584 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-06-26 08:57:20.134676 (Thread-1): finished collecting timing info
2021-06-26 08:57:20.135052 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: ROLLBACK
2021-06-26 08:57:20.306093 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: Close
2021-06-26 08:57:20.496532 (Thread-1): 16:57:20 | 1 of 2 PASS not_null_stg_customers_city.............................. [PASS in 2.16s]
2021-06-26 08:57:20.498734 (Thread-1): Finished running node test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 08:57:20.499091 (Thread-1): Began running node test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 08:57:20.499941 (Thread-1): 16:57:20 | 2 of 2 START test unique_stg_customers_city.......................... [RUN]
2021-06-26 08:57:20.500525 (Thread-1): Acquiring new snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:57:20.500702 (Thread-1): Compiling test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 08:57:20.513704 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"
2021-06-26 08:57:20.514495 (Thread-1): finished collecting timing info
2021-06-26 08:57:20.517938 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:57:20.518088 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: BEGIN
2021-06-26 08:57:20.518214 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 08:57:21.116569 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2021-06-26 08:57:21.117366 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:57:21.117654 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"} */

        

      create or replace transient table test_dbt.public_dbt_test__audit.unique_stg_customers_city  as
      (
    
    

select
    city,
    count(*) as n_records

from test_dbt.public.stg_customers
where city is not null
group by city
having count(*) > 1



      );
2021-06-26 08:57:21.966003 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-06-26 08:57:21.969398 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: COMMIT
2021-06-26 08:57:21.969978 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:57:21.970176 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: COMMIT
2021-06-26 08:57:22.088518 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-06-26 08:57:22.090419 (Thread-1): Writing runtime SQL for node "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"
2021-06-26 08:57:22.094283 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:57:22.094600 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: BEGIN
2021-06-26 08:57:22.230512 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-06-26 08:57:22.231153 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 08:57:22.231434 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from test_dbt.public_dbt_test__audit.unique_stg_customers_city
    
      
    ) dbt_internal_test
2021-06-26 08:57:22.474672 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-06-26 08:57:22.477624 (Thread-1): finished collecting timing info
2021-06-26 08:57:22.477990 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: ROLLBACK
2021-06-26 08:57:22.648811 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: Close
2021-06-26 08:57:22.842694 (Thread-1): 16:57:22 | 2 of 2 FAIL 19 unique_stg_customers_city............................. [FAIL 19 in 2.34s]
2021-06-26 08:57:22.843291 (Thread-1): Finished running node test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 08:57:22.845974 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 08:57:22.846493 (MainThread): 16:57:22 | 
2021-06-26 08:57:22.846691 (MainThread): 16:57:22 | Finished running 2 tests in 8.84s.
2021-06-26 08:57:22.846950 (MainThread): Connection 'master' was properly closed.
2021-06-26 08:57:22.847217 (MainThread): Connection 'test.my_new_project.unique_stg_customers_city.d7a01e6fd1' was properly closed.
2021-06-26 08:57:22.857381 (MainThread): 
2021-06-26 08:57:22.857574 (MainThread): Completed with 1 error and 0 warnings:
2021-06-26 08:57:22.857708 (MainThread): 
2021-06-26 08:57:22.857847 (MainThread): Failure in test unique_stg_customers_city (models/staging/customer_data/stg_cutomers.yml)
2021-06-26 08:57:22.857964 (MainThread):   Got 19 results, configured to fail if != 0
2021-06-26 08:57:22.858080 (MainThread): 
2021-06-26 08:57:22.858198 (MainThread):   compiled SQL at target/compiled/my_new_project/models/staging/customer_data/stg_cutomers.yml/schema_test/unique_stg_customers_city.sql
2021-06-26 08:57:22.858320 (MainThread): 
2021-06-26 08:57:22.858435 (MainThread):   See test failures:
  -----------------------------------------------------------------------
  select * from test_dbt.public_dbt_test__audit.unique_stg_customers_city
  -----------------------------------------------------------------------
2021-06-26 08:57:22.858571 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-06-26 08:57:22.858792 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b8c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f88be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a4a30>]}
2021-06-26 08:57:22.859056 (MainThread): Flushing usage events
2021-06-26 09:10:21.307672 (MainThread): Running with dbt=0.20.0-rc1
2021-06-26 09:10:21.838317 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/ashsmith/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, store_failures=True, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-26 09:10:21.840192 (MainThread): Tracking: tracking
2021-06-26 09:10:21.841310 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c65490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f9fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f9fbe0>]}
2021-06-26 09:10:21.852315 (MainThread): Partial parsing not enabled
2021-06-26 09:10:21.865187 (MainThread): Parsing macros/catalog.sql
2021-06-26 09:10:21.867138 (MainThread): Parsing macros/adapters.sql
2021-06-26 09:10:21.889513 (MainThread): Parsing macros/materializations/merge.sql
2021-06-26 09:10:21.890919 (MainThread): Parsing macros/materializations/view.sql
2021-06-26 09:10:21.891867 (MainThread): Parsing macros/materializations/table.sql
2021-06-26 09:10:21.894636 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-26 09:10:21.901155 (MainThread): Parsing macros/core.sql
2021-06-26 09:10:21.903839 (MainThread): Parsing macros/materializations/test.sql
2021-06-26 09:10:21.907676 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-26 09:10:21.914810 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-26 09:10:21.915957 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-26 09:10:21.928788 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-26 09:10:21.955753 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-26 09:10:21.971773 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-26 09:10:21.972994 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-26 09:10:21.978622 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-26 09:10:21.989235 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-26 09:10:21.994542 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-26 09:10:21.999189 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-26 09:10:22.002631 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-26 09:10:22.003191 (MainThread): Parsing macros/etc/query.sql
2021-06-26 09:10:22.003812 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-26 09:10:22.004868 (MainThread): Parsing macros/etc/datetime.sql
2021-06-26 09:10:22.011253 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-26 09:10:22.012535 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-26 09:10:22.013580 (MainThread): Parsing macros/adapters/common.sql
2021-06-26 09:10:22.048418 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-26 09:10:22.049576 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-26 09:10:22.050325 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-26 09:10:22.051182 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-26 09:10:22.168922 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_customers".
2021-06-26 09:10:22.175591 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_order_details".
2021-06-26 09:10:22.177875 (MainThread): Acquiring new snowflake connection "model.my_new_project.stg_orders".
2021-06-26 09:10:22.179948 (MainThread): Acquiring new snowflake connection "model.my_new_project.customer_orders".
2021-06-26 09:10:22.188988 (MainThread): Acquiring new snowflake connection "test.my_new_project.assert_city_exists".
2021-06-26 09:10:22.190605 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 09:10:22.206440 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 09:10:22.207633 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-26 09:10:22.223755 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-26 09:10:22.227209 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24763886-4b1b-4686-820b-15f9568dec10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11211ad90>]}
2021-06-26 09:10:22.231342 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24763886-4b1b-4686-820b-15f9568dec10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121287f0>]}
2021-06-26 09:10:22.231484 (MainThread): Found 4 models, 3 tests, 0 snapshots, 0 analyses, 149 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-06-26 09:10:22.232266 (MainThread): 
2021-06-26 09:10:22.232430 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 09:10:22.233096 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_test_dbt".
2021-06-26 09:10:22.241902 (ThreadPoolExecutor-0_0): Using snowflake connection "list_test_dbt".
2021-06-26 09:10:22.241963 (ThreadPoolExecutor-0_0): On list_test_dbt: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt"} */

    show terse schemas in database test_dbt
    limit 10000
2021-06-26 09:10:22.242013 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-26 09:10:23.134221 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.89 seconds
2021-06-26 09:10:23.142379 (ThreadPoolExecutor-0_0): On list_test_dbt: Close
2021-06-26 09:10:23.329597 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public".
2021-06-26 09:10:23.342406 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public".
2021-06-26 09:10:23.342572 (ThreadPoolExecutor-1_0): On list_test_dbt_public: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public"} */

    show terse objects in test_dbt.public
2021-06-26 09:10:23.342707 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 09:10:24.150468 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.81 seconds
2021-06-26 09:10:24.155239 (ThreadPoolExecutor-1_0): On list_test_dbt_public: Close
2021-06-26 09:10:24.344697 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 09:10:24.348383 (ThreadPoolExecutor-1_0): Using snowflake connection "list_test_dbt_public_dbt_test__audit".
2021-06-26 09:10:24.348553 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "connection_name": "list_test_dbt_public_dbt_test__audit"} */

    show terse objects in test_dbt.public_dbt_test__audit
2021-06-26 09:10:24.348711 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-26 09:10:24.945394 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.60 seconds
2021-06-26 09:10:24.949367 (ThreadPoolExecutor-1_0): On list_test_dbt_public_dbt_test__audit: Close
2021-06-26 09:10:25.143748 (MainThread): 17:10:25 | Concurrency: 1 threads (target='dev')
2021-06-26 09:10:25.144349 (MainThread): 17:10:25 | 
2021-06-26 09:10:25.147245 (Thread-1): Began running node test.my_new_project.assert_city_exists
2021-06-26 09:10:25.147682 (Thread-1): 17:10:25 | 1 of 3 START test assert_city_exists................................. [RUN]
2021-06-26 09:10:25.148206 (Thread-1): Acquiring new snowflake connection "test.my_new_project.assert_city_exists".
2021-06-26 09:10:25.148536 (Thread-1): Compiling test.my_new_project.assert_city_exists
2021-06-26 09:10:25.153101 (Thread-1): Writing injected SQL for node "test.my_new_project.assert_city_exists"
2021-06-26 09:10:25.155037 (Thread-1): finished collecting timing info
2021-06-26 09:10:25.190804 (Thread-1): Using snowflake connection "test.my_new_project.assert_city_exists".
2021-06-26 09:10:25.190979 (Thread-1): On test.my_new_project.assert_city_exists: BEGIN
2021-06-26 09:10:25.191068 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 09:10:25.999936 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-06-26 09:10:26.000700 (Thread-1): Using snowflake connection "test.my_new_project.assert_city_exists".
2021-06-26 09:10:26.000919 (Thread-1): On test.my_new_project.assert_city_exists: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.assert_city_exists"} */

        

      create or replace transient table test_dbt.public_dbt_test__audit.assert_city_exists  as
      (-- The city perth must exist in RAW or fail
select
    city
from test_dbt.public.stg_customers
WHERE city = "perth"
      );
2021-06-26 09:10:26.166999 (Thread-1): Snowflake query id: 019d2ea6-3200-5157-0000-65a900023e1a
2021-06-26 09:10:26.167333 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 13
invalid identifier '"perth"'
2021-06-26 09:10:26.167814 (Thread-1): finished collecting timing info
2021-06-26 09:10:26.168120 (Thread-1): On test.my_new_project.assert_city_exists: ROLLBACK
2021-06-26 09:10:26.329230 (Thread-1): On test.my_new_project.assert_city_exists: Close
2021-06-26 09:10:26.520266 (Thread-1): Database Error in test assert_city_exists (tests/assert_city_exists.sql)
  000904 (42000): SQL compilation error: error line 6 at position 13
  invalid identifier '"perth"'
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    yield
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 693, in execute
    Error.errorhandler_wrapper(
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 6 at position 13
invalid identifier '"perth"'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/task/test.py", line 82, in execute_test
    macro_func()
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 74, in macro
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.10/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt@0.20.0-rc1/0.20.0rc1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test assert_city_exists (tests/assert_city_exists.sql)
  000904 (42000): SQL compilation error: error line 6 at position 13
  invalid identifier '"perth"'
2021-06-26 09:10:26.524018 (Thread-1): 17:10:26 | 1 of 3 ERROR assert_city_exists...................................... [ERROR in 1.38s]
2021-06-26 09:10:26.524257 (Thread-1): Finished running node test.my_new_project.assert_city_exists
2021-06-26 09:10:26.524495 (Thread-1): Began running node test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 09:10:26.525324 (Thread-1): 17:10:26 | 2 of 3 START test not_null_stg_customers_city........................ [RUN]
2021-06-26 09:10:26.525874 (Thread-1): Acquiring new snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 09:10:26.526064 (Thread-1): Compiling test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 09:10:26.539045 (Thread-1): Writing injected SQL for node "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"
2021-06-26 09:10:26.540217 (Thread-1): finished collecting timing info
2021-06-26 09:10:26.548528 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 09:10:26.548687 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"} */
drop table if exists "TEST_DBT"."PUBLIC_DBT_TEST__AUDIT"."NOT_NULL_STG_CUSTOMERS_CITY" cascade
2021-06-26 09:10:26.548799 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 09:10:27.236014 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-06-26 09:10:27.241963 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 09:10:27.242147 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: BEGIN
2021-06-26 09:10:27.382173 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-06-26 09:10:27.383021 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 09:10:27.383326 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"} */

        

      create or replace transient table test_dbt.public_dbt_test__audit.not_null_stg_customers_city  as
      (
    
    

select *
from test_dbt.public.stg_customers
where city is null



      );
2021-06-26 09:10:28.437032 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-06-26 09:10:28.439803 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: COMMIT
2021-06-26 09:10:28.440146 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 09:10:28.440298 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: COMMIT
2021-06-26 09:10:28.543927 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-06-26 09:10:28.545276 (Thread-1): Writing runtime SQL for node "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"
2021-06-26 09:10:28.549325 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 09:10:28.549614 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: BEGIN
2021-06-26 09:10:28.672533 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-06-26 09:10:28.673180 (Thread-1): Using snowflake connection "test.my_new_project.not_null_stg_customers_city.48dac9b3ab".
2021-06-26 09:10:28.673450 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_customers_city.48dac9b3ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from test_dbt.public_dbt_test__audit.not_null_stg_customers_city
    
      
    ) dbt_internal_test
2021-06-26 09:10:28.852671 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-06-26 09:10:28.857694 (Thread-1): finished collecting timing info
2021-06-26 09:10:28.858272 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: ROLLBACK
2021-06-26 09:10:29.034114 (Thread-1): On test.my_new_project.not_null_stg_customers_city.48dac9b3ab: Close
2021-06-26 09:10:29.273334 (Thread-1): 17:10:29 | 2 of 3 PASS not_null_stg_customers_city.............................. [PASS in 2.75s]
2021-06-26 09:10:29.273761 (Thread-1): Finished running node test.my_new_project.not_null_stg_customers_city.48dac9b3ab
2021-06-26 09:10:29.274079 (Thread-1): Began running node test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 09:10:29.274370 (Thread-1): 17:10:29 | 3 of 3 START test unique_stg_customers_city.......................... [RUN]
2021-06-26 09:10:29.275247 (Thread-1): Acquiring new snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 09:10:29.275538 (Thread-1): Compiling test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 09:10:29.289262 (Thread-1): Writing injected SQL for node "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"
2021-06-26 09:10:29.290000 (Thread-1): finished collecting timing info
2021-06-26 09:10:29.294287 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 09:10:29.294450 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"} */
drop table if exists "TEST_DBT"."PUBLIC_DBT_TEST__AUDIT"."UNIQUE_STG_CUSTOMERS_CITY" cascade
2021-06-26 09:10:29.294587 (Thread-1): Opening a new connection, currently in state closed
2021-06-26 09:10:29.902301 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-06-26 09:10:29.908637 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 09:10:29.909028 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: BEGIN
2021-06-26 09:10:30.048009 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-06-26 09:10:30.048627 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 09:10:30.048876 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"} */

        

      create or replace transient table test_dbt.public_dbt_test__audit.unique_stg_customers_city  as
      (
    
    

select
    city,
    count(*) as n_records

from test_dbt.public.stg_customers
where city is not null
group by city
having count(*) > 1



      );
2021-06-26 09:10:31.120480 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-06-26 09:10:31.123416 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: COMMIT
2021-06-26 09:10:31.123700 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 09:10:31.123844 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: COMMIT
2021-06-26 09:10:31.308370 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-06-26 09:10:31.309882 (Thread-1): Writing runtime SQL for node "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"
2021-06-26 09:10:31.312563 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 09:10:31.312789 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: BEGIN
2021-06-26 09:10:31.553443 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-06-26 09:10:31.554092 (Thread-1): Using snowflake connection "test.my_new_project.unique_stg_customers_city.d7a01e6fd1".
2021-06-26 09:10:31.554411 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "default", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_customers_city.d7a01e6fd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from test_dbt.public_dbt_test__audit.unique_stg_customers_city
    
      
    ) dbt_internal_test
2021-06-26 09:10:31.796703 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-06-26 09:10:31.799916 (Thread-1): finished collecting timing info
2021-06-26 09:10:31.800481 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: ROLLBACK
2021-06-26 09:10:32.013001 (Thread-1): On test.my_new_project.unique_stg_customers_city.d7a01e6fd1: Close
2021-06-26 09:10:32.232027 (Thread-1): 17:10:32 | 3 of 3 FAIL 19 unique_stg_customers_city............................. [FAIL 19 in 2.96s]
2021-06-26 09:10:32.232346 (Thread-1): Finished running node test.my_new_project.unique_stg_customers_city.d7a01e6fd1
2021-06-26 09:10:32.234646 (MainThread): Acquiring new snowflake connection "master".
2021-06-26 09:10:32.235136 (MainThread): 17:10:32 | 
2021-06-26 09:10:32.235324 (MainThread): 17:10:32 | Finished running 3 tests in 10.00s.
2021-06-26 09:10:32.235479 (MainThread): Connection 'master' was properly closed.
2021-06-26 09:10:32.235595 (MainThread): Connection 'test.my_new_project.unique_stg_customers_city.d7a01e6fd1' was properly closed.
2021-06-26 09:10:32.244393 (MainThread): 
2021-06-26 09:10:32.244635 (MainThread): Completed with 2 errors and 0 warnings:
2021-06-26 09:10:32.244782 (MainThread): 
2021-06-26 09:10:32.244919 (MainThread): Database Error in test assert_city_exists (tests/assert_city_exists.sql)
2021-06-26 09:10:32.245035 (MainThread):   000904 (42000): SQL compilation error: error line 6 at position 13
2021-06-26 09:10:32.245141 (MainThread):   invalid identifier '"perth"'
2021-06-26 09:10:32.245254 (MainThread): 
2021-06-26 09:10:32.245385 (MainThread): Failure in test unique_stg_customers_city (models/staging/customer_data/stg_cutomers.yml)
2021-06-26 09:10:32.245494 (MainThread):   Got 19 results, configured to fail if != 0
2021-06-26 09:10:32.245603 (MainThread): 
2021-06-26 09:10:32.245716 (MainThread):   compiled SQL at target/compiled/my_new_project/models/staging/customer_data/stg_cutomers.yml/schema_test/unique_stg_customers_city.sql
2021-06-26 09:10:32.245832 (MainThread): 
2021-06-26 09:10:32.245943 (MainThread):   See test failures:
  -----------------------------------------------------------------------
  select * from test_dbt.public_dbt_test__audit.unique_stg_customers_city
  -----------------------------------------------------------------------
2021-06-26 09:10:32.246081 (MainThread): 
Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
2021-06-26 09:10:32.246300 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112089eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b5fd0>]}
2021-06-26 09:10:32.246573 (MainThread): Flushing usage events
